<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="C++语法笔记, ヅツツ"><meta name="description" content=""><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>C++语法笔记 | ヅツツ</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" type="text/css" href="/css/loading.css"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css"><link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><script src="/libs/jquery/jquery.min.js"></script><meta name="generator" content="Hexo 5.4.1"><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style><link rel="alternate" href="/atom.xml" title="ヅツツ" type="application/atom+xml"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>$(document).ready(function(){document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")})</script><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="/medias/logo.png" class="logo-img" alt="LOGO"> <span class="logo-span">ヅツツ</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fas fa-tags" style="zoom:.6"></i> <span>标签</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fas fa-bookmark" style="zoom:.6"></i> <span>分类</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fas fa-archive" style="zoom:.6"></i> <span>归档</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">ヅツツ</div><div class="logo-desc">Never really desperate, only the lost of the soul.</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fa-fw fas fa-tags"></i> 标签</a></li><li class="m-nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fa-fw fas fa-bookmark"></i> 分类</a></li><li class="m-nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa-fw fas fa-archive"></i> 归档</a></li></ul></div></div></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(/medias/featureimages/7.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">C++语法笔记</h1></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><style>#articleContent h1::before,#articleContent h2::before,#articleContent h3::before,#articleContent h4::before,#articleContent h5::before,#articleContent h6::before{display:block;content:" ";height:100px;margin-top:-100px;visibility:hidden}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{width:345px;padding-left:20px}.toc-widget .toc-title{padding:35px 0 15px 17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content{padding-bottom:30px;overflow:auto}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px;position:absolute;right:23.5vw;display:block}#toc-content .is-active-link{color:#42b983}#floating-toc-btn{position:fixed;right:15px;bottom:76px;padding-top:15px;margin-bottom:0;z-index:998}#floating-toc-btn .btn-floating{width:48px;height:48px}#floating-toc-btn .btn-floating i{line-height:48px;font-size:1.4rem}</style><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/C-98/"><span class="chip bg-color">C++98</span> </a><a href="/tags/C-11/"><span class="chip bg-color">C++11</span> </a><a href="/tags/c-14/"><span class="chip bg-color">c++14</span> </a><a href="/tags/C-17/"><span class="chip bg-color">C++17</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/C/" class="post-category">C++</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp; 2022-02-25</div><div class="post-date info-break-policy"><i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp; 2022-03-26</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp; 30.9k</div><div class="info-break-policy"><i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp; 130 分</div></div></div><hr class="clearfix"><link rel="stylesheet" href="/libs/prism/prism.css"><style type="text/css">code[class*=language-],pre[class*=language-]{white-space:pre-wrap!important}</style><div class="card-content article-card-content"><div id="articleContent"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>是一个整合C++相关书籍以及学习网站所学内容的C++笔记</p><h2 id="C-基本语法"><a href="#C-基本语法" class="headerlink" title="C++基本语法"></a>C++基本语法</h2><h3 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h3><ul><li>int main()描述的是main()和操作系统的接口</li><li>有些编程环境提供的框架程序，该程序调用一些非标准函数，如_tmain()，但实际上还是离不开main()，它有一个隐藏main()，来调用_tmain()</li><li>C++头文件名依旧可以使用C风格，但转换后例如C++版本的math.h为cmath，去掉h不只是形式上的变化，没有h的头文件也可以包含名称空间</li><li>climits文件中定义的两个符号常量（INT_MAX和INT_MIN）来确定其参数是否位于适当的范围内</li></ul><h3 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h3><ul><li><p>使用的内存量越大，可以表示的范围也越大</p></li><li><p>C++的cout某种程度上比C的printf聪明很多，例如：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//会发现错误</span>
cout<span class="token operator">&lt;&lt;</span><span class="token number">25</span><span class="token punctuation">;</span><span class="token comment">//成功打印字符</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p><strong>数据类型</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">int</span> a<span class="token punctuation">;</span> <span class="token comment">// Integer</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span> <span class="token comment">// Unsigned integers only store positive numbers. As a result, they have a higher positive range.</span>
	<span class="token keyword">char</span> c<span class="token punctuation">;</span> <span class="token comment">// Character</span>
	<span class="token keyword">short</span> d<span class="token punctuation">;</span> <span class="token comment">// Short integer</span>
	<span class="token keyword">long</span> e<span class="token punctuation">;</span> <span class="token comment">// Long integer</span>
	<span class="token keyword">float</span> f<span class="token punctuation">;</span> <span class="token comment">// Floating point integer</span>
	<span class="token keyword">double</span> g<span class="token punctuation">;</span> <span class="token comment">// Double-precision floating point integer</span>
	<span class="token keyword">bool</span> h<span class="token punctuation">;</span> <span class="token comment">// Boolean TRUE or FALSE</span>
	<span class="token keyword">auto</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// Automatically infer type. Not a type in itself.</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>初始化</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// C-like initialization</span>
	<span class="token keyword">int</span> b <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// Uniform initialization. Does not allow narrowing conversions.</span>
	<span class="token keyword">int</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Constructor initialization</span>
	<span class="token keyword">char</span> greeting_a<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token char">'H'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'l'</span><span class="token punctuation">,</span><span class="token char">'l'</span><span class="token punctuation">,</span><span class="token char">'o'</span><span class="token punctuation">,</span><span class="token char">'\0'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> greeting_b<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Hello"</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span>string greeting_c <span class="token operator">=</span> <span class="token string">"Hello"</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>存储类说明符</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">extern</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span> <span class="token comment">// defined elsewhere</span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span> <span class="token comment">// hold value between invocations</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>类型限定符</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;atomic&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// a, once defined, is constant and cannot be changed</span>
	std<span class="token double-colon punctuation">::</span>atomic<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> b<span class="token punctuation">;</span> <span class="token comment">// b can only be modified by one thread at a time</span>
	<span class="token keyword">volatile</span> <span class="token keyword">int</span> c<span class="token punctuation">;</span> <span class="token comment">// c can be modified externally. the program will check x's value before using it, even if it hasn't been modified locally.</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>注释</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/*
 * Multi-line comments are written like this.
 */</span>

<span class="token comment">// Single-line comments are written like this.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>类型别名</strong></p><p>C++为类型建立别名的方式有两种：</p><p>一种是使用预处理器#define 别名 typename,以下zzz即char的别名</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">zzz</span> <span class="token expression"><span class="token keyword">char</span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>一种是使用关键字typedef来创建别名typedef typename别名</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">char</span> zzz<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>无符号unsigned + 类型什么时候会用到：确保变量表示的值不可能出现负数，且unsigned所设变量能取更大范围的值</p></li><li><p><strong>字符函数库cctype</strong></p><p>C++从C语言继承了一个与字符相关的、非常方便的函数软件包，它可以简化诸如确定字符是否为大写字母、数字、标点符号等工作</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/20201011111945286.png"></p></li><li><p>16进制前缀：<code>0x</code></p><p>8进制：<code>0</code></p><p>二进制前缀：<code>0b</code></p></li><li><p><strong>浮点数E表示法</strong>：<code>d.ddE+n</code>小数点向右移n位，<code>d.ddE-n</code>小数点左移n位</p><p>右移:<code>3.45E6=3.45E+6=3.450000</code></p><p>左移:<code>3.45E-2=0.0345</code></p><p>浮点常量F/f表示float，E/e表示double，L/l表示long double</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">float</span> a <span class="token operator">=</span> <span class="token number">3.45E+22f</span><span class="token punctuation">;</span>
	<span class="token keyword">float</span> b <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token number">0.1f</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> b <span class="token operator">-</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出J结果是0</p><p><code>因为2.34E+22f是在第23位加上1 ，但float只能表示数字中的前6位或前七位</code></p><p><strong>浮点数与整数相比</strong></p><p>优点：浮点数能表示整数，能表示范围大</p><p>缺点：浮点数运算速度通常比整数慢，且精度降低</p></li><li><p>C++的cout.setf()函数：<a target="_blank" rel="noopener" href="https://blog.csdn.net/baishuiniyaonulia/article/details/79144033">C++ 中的 cout.setf() 函数_白水的博客-CSDN博客_cout.setf()</a></p></li><li><p>类型转换潜在的数值转换问题</p><ul><li><p>将较大的浮点类型转换为较小的浮点类型例如double的2111222333转换为float，精度有效数位降低，四舍五入为2.11122E9</p></li><li><p>将浮点数类型转换为整型=&gt;小数部分丢失，原来的值可能类型的取值范围，在这种情况下，结果将是不确定的</p></li><li><p>将较大的整型转换为较小的整型，如long转换为short，原来的值可能超出目标类型的取值范围，通常只复制右边的字节</p></li><li><p>一种严格的类型转换<code>static_cast&lt;&gt;</code></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token char">'a'</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>结果输出为97</code></p></li></ul></li><li><p>C++11的auto关键字</p><p>简单概括来说auto的自动类型推断发生在编译期，所以使用auto并不会造成程序运行时效率的降低。</p><p>1.auto声明的变量必须必须要初始化，否则编译器不能判断变量的类型</p><p>2.auto不能被声明为返回值，auto不能作为形参，auto不能被修饰为模板参数</p><p>这里举个简单的例子</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">auto</span> t <span class="token operator">=</span> a<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>输出结果为int</code></p><p>详细参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_31930499/article/details/79948906">c++ auto关键字使用_年轻气盛 温顺尚早-CSDN博客_c++auto</a></p></li></ul><h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><h4 id="定长数组"><a href="#定长数组" class="headerlink" title="定长数组"></a>定长数组</h4><p>四种赋值方式</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> array<span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> array<span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>但这种是绝不允许的</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>数组初始化为0</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>其中列表初始化禁止缩窄转换</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">long</span> array<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">25</span>，<span class="token number">92</span>，<span class="token number">3.0</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//浮点数转整型为缩窄操作</span>
<span class="token keyword">char</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token char">'h'</span><span class="token punctuation">,</span><span class="token char">'i'</span><span class="token punctuation">,</span><span class="token number">121212</span><span class="token punctuation">,</span><span class="token char">'\0'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//121212显然超出了char变量的取值范围</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>字符串读入到char数组中末尾会加n个’\0’元素补充数组长度</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">char</span> a<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"abc"</span><span class="token punctuation">;</span><span class="token comment">//内存分配则为a b c \0 \0 \0 \0 \0</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>‘ ‘和“ ”的区别</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">char</span> cue <span class="token operator">=</span> <span class="token char">'s'</span><span class="token punctuation">;</span><span class="token comment">//字符常量赋值给cue</span>
<span class="token keyword">char</span> cue <span class="token operator">=</span> <span class="token string">"s"</span><span class="token punctuation">;</span><span class="token comment">//s和\0组成的字符串，实际上表示的是字符串所在内存地址，不能直接赋值给cue</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>拼接字符串常量，第一个字符串末尾的\0字符会被第二个字符串的首字符代替</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"1"</span>
		<span class="token string">"2"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>输出结果为12</code></p><h4 id="字符串输入的一个坑"><a href="#字符串输入的一个坑" class="headerlink" title="字符串输入的一个坑"></a><strong>字符串输入的一个坑</strong></h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> classes<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"enter your name:"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cin <span class="token operator">&gt;&gt;</span> name<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"enter your class"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cin <span class="token operator">&gt;&gt;</span> classes<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"name:"</span> <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">"\n classes:"</span> <span class="token operator">&lt;&lt;</span> classes<span class="token punctuation">;</span>
	cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220303153230969.png" alt="image-20220303153230969"></p><p>cin把zhoumouren作为第一个字符串，并把它放到name数组，这时把two留在输入队列中，之后cin在输入搜索classes时发现了two，因此直接放入了classes数组之中</p><p>这时候可以引入cin.getline(name,size)，很好的解决了第七的问题，字符的最后位位‘\0’，故最多读取size-1个字符</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> classes<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"enter your name:"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"enter your class:"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>classes<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"name:"</span> <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">"\n classes:"</span> <span class="token operator">&lt;&lt;</span> classes<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220304000927715.png"></p><p>面向行的输入还有cin.get()，但是不能像cin.getline一样直接操作，因为get(name,size)会读取不会丢弃换行符，会将换行符保留在输入序列中，而getline(name,size)会直接丢弃换行符，出现 <code>幻影换行符</code>的问题故想要和getline效果一样，需要以这种形式操作：cin.get(name,size).get()</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> classes<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"enter your name:"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"enter your class:"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>classes<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"name:"</span> <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">"\n classes:"</span> <span class="token operator">&lt;&lt;</span> classes<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220304000927715.png"></p><p>还有另外一种<code>幻影换行符</code>的例子，混合输入字符串和数字会出现的问题</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> year<span class="token punctuation">;</span>
	<span class="token keyword">char</span> classes<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"enter your year:"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cin<span class="token operator">&gt;&gt;</span>year<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"enter your class:"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>classes<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"name:"</span> <span class="token operator">&lt;&lt;</span>year <span class="token operator">&lt;&lt;</span> <span class="token string">"\n classes:"</span> <span class="token operator">&lt;&lt;</span> classes<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220304001527750.png"></p><p>因为这时候cin&gt;&gt;year会将换行符同样留在输入流中，只要在后面cin.get()或者将cin&gt;&gt;year改成(cin&gt;&gt;year).get()即可</p><h4 id="数组的替代品"><a href="#数组的替代品" class="headerlink" title="数组的替代品"></a><strong>数组的替代品</strong></h4><p><strong>模板类vector</strong></p><p>模板类vector类似于string类，也是一种动态数组。是由C++98新增的标准模板库（STL）提供的。您在运行阶段设置vector对象的长度，可在末尾添加新数据，还可在中间插入新数据。实际上vector类确实使用new和delete来管理内存，但这种工作是自动完成的。使用时需要包含头文件vector。</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">5</span>
	cout <span class="token operator">&lt;&lt;</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>模板类array（C++11）</strong></p><p>vector类的功能比数组强大，但付出的代价是效率稍低。如果你需要的是长度固定的数组<br>，使用数组是更佳的选择，但代价是不那么方便和安全。故C++11新增了模板类array，它也位于名称空间std中。array对象的长度是固定的，是使用栈存储的，因此效率和数组相同，更方便，更安全。使用时需要包含头文件array。</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;array&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//array&lt;typename,n_elem&gt; a=&gt;typename指变量类型，a指数组名称，n_elem表示大小</span>
	array<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">&gt;</span> a<span class="token punctuation">;</span>
	a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>以下是可行的</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;array&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	array<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">&gt;</span> a<span class="token punctuation">;</span>
	array<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">&gt;</span> d<span class="token punctuation">;</span>
	vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 	a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10</span>
	b <span class="token operator">=</span> c<span class="token punctuation">;</span>
	d <span class="token operator">=</span> a<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220308003622889.png"></p><p><strong>非法索引</strong></p><p>与C语言一样，C++也不检查这种超界错误</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;array&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">double</span> array<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	array<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> array<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220308004152237.png"></p><p>可以用vector和array对象函数at()在运行期间来捕获这些非法索引，而这种检查的代价是运行时间更长，但好处在于降低意外越界错误的概率（目前VS2022在使用了模板类array和vector，不加at也会抛出异常）</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;array&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	array<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">&gt;</span> a<span class="token punctuation">;</span>
	a<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> a<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220308004551157.png"></p><h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><p>i++：先取值再加1<br>++i：先加1再取值<br>i- - ：先取值再减1<br>- -i ：先减1再取值</p><p><strong>for循环</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">//循环体</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><code>for可以是空表达式，而while不行，这里for表示的空表达式是无限循环</code></p><p><strong>while循环</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">//循环体</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>do while循环</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">do</span><span class="token punctuation">{</span>
<span class="token comment">//i++,循环体</span>
<span class="token punctuation">}</span><span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;=</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//i=31 循环中断</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>size_t</strong></p><p>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41598072/article/details/84924997">AplusX</a></p><p>在32位架构中被普遍定义为：</p><p>typedef unsigned int size_t;</p><p>而在64位架构中被定义为：</p><p>typedef unsigned long size_t;</p><p>为什么有时候不用int，而是用size_type或者size_t</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">与<span class="token keyword">int</span>固定四个字节不同有所不同<span class="token punctuation">,</span>size_t的取值range是目标平台下最大可能的数组尺寸<span class="token punctuation">,</span>一些平台下size_t的范围小于<span class="token keyword">int</span>的正数范围<span class="token punctuation">,</span>又或者大于<span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">.</span> 使用Int既有可能浪费，又有可能范围不够大<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>对int类型数组遍历</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;array&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>array<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">&gt;</span> my_array<span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> my_array<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		my_array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> my_array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220312220133095.png"></p><p><strong>对容器的遍历</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;array&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	array<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> length<span class="token operator">&gt;</span> arr<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		arr<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">:</span> arr<span class="token punctuation">)</span>
		cout <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220308184305010.png"></p><p><strong>对列表的遍历</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;array&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		cout <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220308184554900.png"></p><p><strong>修改数组元素</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;array&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	array<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> length<span class="token operator">&gt;</span> arr<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		arr<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span>x <span class="token operator">:</span> arr<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
	
		x <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>文件尾条件</strong></p><p>EOF：一种功能强大的技术，且是在文件iostream中定义的<br>很多PC编程环境都将ctrl+z视为模拟的EOF<br>举个例子cin.eof()</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">char</span> ch<span class="token punctuation">;</span>
	<span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cin<span class="token punctuation">.</span><span class="token function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> ch<span class="token punctuation">;</span>
		<span class="token operator">++</span>count<span class="token punctuation">;</span>
		cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> count <span class="token operator">&lt;&lt;</span> <span class="token string">"characters read\n"</span><span class="token punctuation">;</span>
	
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220308201823128.png" alt="其中enter字符也被纳入计数"></p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220308201849624.png"></p><p>还可以这样</p><p><img src="https://img-blog.csdnimg.cn/20201010161332689.png#pic_center"></p><p>或是这样</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/20201010161402919.png"><br>最后一种会更通用，因为它可以检测到其他失败原因，如磁盘故障<br>精简后为</p><p><img src="https://img-blog.csdnimg.cn/20201010162403986.png#pic_center"></p><h3 id="分支语句与逻辑运算符"><a href="#分支语句与逻辑运算符" class="headerlink" title="分支语句与逻辑运算符"></a>分支语句与逻辑运算符</h3><h4 id="if…else-语句和逻辑运算符"><a href="#if…else-语句和逻辑运算符" class="headerlink" title="if…else 语句和逻辑运算符"></a>if…else 语句和逻辑运算符</h4><p>if and if…else结构<br>if… else if… else结构<br>逻辑运算符or&lt;=&gt;||<br>逻辑运算符AND&lt;=&gt;&amp;&amp;<br>逻辑运算符NOT&lt;=&gt;!</p><ul><li><p>?:运算符：条件运算符，它是C++中唯一需要3个操作数的运算符</p><p><strong>expression1 ? expression2 :expression3</strong><br>如果expression1 为true，则整个条件表达式的值为expression2的值，否则整个表达式的值为expression3的值</p></li></ul><h4 id="switch…case语句"><a href="#switch…case语句" class="headerlink" title="switch…case语句"></a><strong>switch…case语句</strong></h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> choice<span class="token punctuation">;</span>
	<span class="token keyword">enum</span> <span class="token class-name">spectrum</span>
	<span class="token punctuation">{</span>
		red <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
		blue<span class="token punctuation">,</span>
		green
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	cin <span class="token operator">&gt;&gt;</span> choice<span class="token punctuation">;</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>choice<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
	<span class="token keyword">case</span> red<span class="token operator">:</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"is red"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> blue<span class="token operator">:</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"is blue"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> green<span class="token operator">:</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"is green"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">default</span><span class="token operator">:</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"no red blue green"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220309003342175.png"></p><p>switch和if else</p><ul><li>switch中case的值必须是整数（包括char），因此switch无法处理浮点数，如果是涉及取值范围、浮点测试或两个变量的比较，则应使用if else语句。</li><li>如果所有的选项都可以使用整数常量来标识，则可以优先使用switch语句，因为如果选项超过两个，则就代码长度和执行速度而言，switch语句的效率更高</li></ul><h4 id="break-continue-goto"><a href="#break-continue-goto" class="headerlink" title="break continue goto"></a>break continue goto</h4><p>break：打破循环<br>continue：跳过该轮循环<br>goto↓</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">goto</span> zhoumouren<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
 	
zhoumouren<span class="token operator">:</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token number">2</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="简单文本文件输入输出"><a href="#简单文本文件输入输出" class="headerlink" title="简单文本文件输入输出"></a>简单文本文件输入输出</h3><h4 id="写入文本文件"><a href="#写入文本文件" class="headerlink" title="写入文本文件"></a>写入文本文件</h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	ofstream outfile<span class="token punctuation">;</span>
	outfile<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"D:\\Learning\\C++_learning\\zhoumouren.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	outfile <span class="token operator">&lt;&lt;</span> <span class="token string">"zhoumouren"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	outfile <span class="token operator">&lt;&lt;</span> <span class="token string">"666666"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	outfile<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220309011923021.png"></p><h4 id="读取文本文件"><a href="#读取文本文件" class="headerlink" title="读取文本文件"></a>读取文本文件</h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	ifstream infile<span class="token punctuation">;</span>
	infile<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"D:\\Learning\\C++_learning\\zhoumouren.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	string value<span class="token punctuation">;</span>
	<span class="token comment">//inFile.eof():判断是否到达EOF</span>
	<span class="token comment">//inFile.fail() :可以用于检查EOF和类型不匹配</span>
	<span class="token comment">//inFile.good() :指出最后一次读取输入的操作是否成功</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>infile<span class="token punctuation">.</span><span class="token function">is_open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>infile<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span>
		cout <span class="token operator">&lt;&lt;</span> value <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	infile<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220309011845059.png"></p><h3 id="string"><a href="#string" class="headerlink" title="string"></a>string</h3><p>string对象和字符数组之间的主要区别是可以将string对象声明为简单变量，而不是数组，且类设计能让程序自动处理string的大小，这使得与使用字符数组相比，使用string对象更方便，更安全。从理论上来说，可以将char数组视为一组用于存储一个字符串的char存储单元，而string类变量是一个表示字符串的实体。</p><h4 id="string的赋值、拼接和附加"><a href="#string的赋值、拼接和附加" class="headerlink" title="string的赋值、拼接和附加"></a>string的赋值、拼接和附加</h4><ul><li><p>赋值</p><p>不能将一个数组赋给另一个数组，但可以将一个string对象赋给另一个string对象</p></li><li><p>拼接和附加</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	string a <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>
	string b <span class="token operator">=</span> <span class="token string">"def"</span><span class="token punctuation">;</span>
	string c <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> c <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220304165705146.png"></p></li></ul><h4 id="输出带引号的字符串"><a href="#输出带引号的字符串" class="headerlink" title="输出带引号的字符串"></a><strong>输出带引号的字符串</strong></h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\"aaa\""</span><span class="token punctuation">;</span> <span class="token comment">//第一种方式</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token raw-string string">R"("aaa")"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">//第二种方式</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220304170137383.png"></p><p><strong>但是原始字符串中若有括号()，则需要使用另一种方式替代默认定界符“（和）”</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token raw-string string">R"+*(aaa "(bbb)" cccc)+*"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220304170849987.png"></p><h4 id="字符串长度"><a href="#字符串长度" class="headerlink" title="字符串长度"></a><strong>字符串长度</strong></h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	string a <span class="token operator">=</span> <span class="token string">"bbb"</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"cc"</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> a<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span>endl <span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220304171713523.png"></p><h4 id="string的输入方法"><a href="#string的输入方法" class="headerlink" title="string的输入方法"></a><strong>string的输入方法</strong></h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	string a<span class="token punctuation">;</span>
	cin <span class="token operator">&gt;&gt;</span> a<span class="token punctuation">;</span><span class="token comment">//第一种</span>
	<span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//第二种</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h3><p>C++ OOP类的基石就是结构</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/20201006115129590.png"></p><p><strong>C++11结构初始化、赋值、结构声明、结构数组</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">oneman</span>
<span class="token punctuation">{</span>
	string name<span class="token punctuation">;</span>
	<span class="token keyword">int</span> year<span class="token punctuation">;</span>
<span class="token punctuation">}</span>c<span class="token punctuation">;</span><span class="token comment">//结构声明</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	oneman a<span class="token punctuation">{</span> <span class="token string">"zhoumouren"</span><span class="token punctuation">,</span><span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	oneman b<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//默认初始化</span>
	b <span class="token operator">=</span> a<span class="token punctuation">;</span><span class="token comment">//赋值</span>
	c <span class="token operator">=</span> b<span class="token punctuation">;</span><span class="token comment">//赋值</span>
	oneman d<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token string">"zhou"</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">"mou"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//结构数组</span>
	cout <span class="token operator">&lt;&lt;</span> a<span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> b<span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span>endl<span class="token operator">&lt;&lt;</span> c<span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220304174036447.png"></p><h3 id="共用体"><a href="#共用体" class="headerlink" title="共用体"></a>共用体</h3><p>union是一种特殊的数据类型，可以在同一内存位置存储不同的数据类型。可以定义具有多个成员的union，但在任何给定时间，只有一个成员可以包含值。union提供了一种将同一内存位置用于多种目的的有效方法。union的大小将是最大组成类型的大小。可以参考<a target="_blank" rel="noopener" href="https://www.runoob.com/cprogramming/c-unions.html">C 共用体 | 菜鸟教程 (runoob.com)</a></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">union</span> my_data <span class="token punctuation">{</span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
	<span class="token keyword">float</span> f<span class="token punctuation">;</span>
	<span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">union</span> my_data object1<span class="token punctuation">;</span>        
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Size of my_data union: "</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>object1<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220312231535081.png"></p><h3 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h3><p>定义枚举类型的主要目的是：增加程序的可读性。枚举类型最常见也最有意义的用处之一就是用来描述状态量</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">enum</span> <span class="token class-name">zhoumouren</span><span class="token punctuation">{</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>e<span class="token punctuation">,</span>f<span class="token punctuation">,</span>g<span class="token punctuation">,</span>h<span class="token punctuation">}</span><span class="token punctuation">;</span>
	zhoumouren zmr <span class="token operator">=</span> c<span class="token punctuation">;</span><span class="token comment">//不初始化也行</span>
	zmr <span class="token operator">=</span> c<span class="token punctuation">;</span>
	<span class="token comment">//zmr = 2;not valid</span>
	<span class="token comment">//zmr++;not valid</span>
	<span class="token comment">//zmr = a+b;not valid</span>
	<span class="token keyword">int</span> num <span class="token operator">=</span> c<span class="token punctuation">;</span><span class="token comment">//valid</span>
	zmr <span class="token operator">=</span> <span class="token function">zhoumouren</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//valid</span>
	zmr <span class="token operator">=</span> <span class="token function">zhoumouren</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//虽然有输出,但这么写不合适</span>
	<span class="token keyword">enum</span> <span class="token class-name">bits</span><span class="token punctuation">{</span>one<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>two<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>four<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>eight<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//显示设置枚举量的值</span>
	<span class="token keyword">enum</span> <span class="token class-name">bigstep</span><span class="token punctuation">{</span>first<span class="token punctuation">,</span>second<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>third<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//first在默认情况下为0,后面的third没被初始化,比前面的枚举量大1，为101</span>
	<span class="token keyword">enum</span> <span class="token punctuation">{</span>zero<span class="token punctuation">,</span>null <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>one<span class="token punctuation">,</span>numero_uno<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//zero和null都为0,one和umero_uno都为1</span>
	cout <span class="token operator">&lt;&lt;</span> zmr <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> c <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>C++早期版本中,只能将int值赋给枚举量,但是后来这种限制取消了,因此可以使用long甚至long long类型的值</p><p>枚举的取值范围:拿<code>bigstep</code>举例,最大值(最小值)都得看大于(小于)这个最大枚举量(最小枚举量)的2的幂,例如third为101,即看<code>2的七次方将它减去1就是这个枚举的上限127</code>.同理<code>下限一般为0</code>.若最小枚举量为-6,则把他看成正数6,操作和上面步骤一样最后再取个负号就是-7</p><p>一般选择多少空间来存储枚举由编译器决定,对于取值范围小的枚举使用一个字节或更少的空间,而对于包含long类型值的枚举,则使用4个字节</p><h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><p>指针和自由存储空间</p><p>指针策略是C++内存管理变成理念的核心</p><h4 id="指针和C-基本原理"><a href="#指针和C-基本原理" class="headerlink" title="指针和C++基本原理"></a><strong>指针和C++基本原理</strong></h4><p>C++编译过程:预处理、编译、汇编、链接成可执行文件(window下为.exe)</p><p>OOP（Object Oriented Programming）编程与传统编程区别:OOP强调运行阶段而不是编译阶段。传统编译过程需要指定数组长度，如果要分配200个元素的空间，如果你只用到其中20个元素的空间，如果编译阶段进行决策那么就确定是需要200个元素的空间，如果你只用到其中20个元素的空间，这就是在浪费内存，所以OOP通过运行阶段决策可以灵活告诉程序只需要用到20个元素的空间。这里采用的方法是<code>使用关键字new请求正确数量的内存以及使用指针来跟踪新分配的内存的位置</code></p><ul><li>在运行阶段做决策并非OOP独有的，但使用C++编写这样的代码比C语言更简单</li><li>*运算符被称为间接值或解除引用运算符</li></ul><p><strong>初始化</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span><span class="token operator">*</span> zmr <span class="token operator">=</span> <span class="token operator">&amp;</span>value<span class="token punctuation">;</span><span class="token comment">//第一种初始化方法</span>
		<span class="token keyword">int</span><span class="token operator">*</span> zt<span class="token punctuation">;</span>
		zt <span class="token operator">=</span> <span class="token operator">&amp;</span>value<span class="token punctuation">;</span><span class="token comment">//第二种初始化方法</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"address:"</span> <span class="token operator">&lt;&lt;</span> zmr <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"value:"</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>zmr <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"address:"</span> <span class="token operator">&lt;&lt;</span> zt <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"value:"</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>zt <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="指针的危险"><a href="#指针的危险" class="headerlink" title="指针的危险"></a><strong>指针的危险</strong></h4><p>​ <code>*pointer_values=3333;</code></p><p>没有表明地址，指针不一定指向存储3333的地址，这种错误会导致一些最隐匿、最难以跟踪的bug，所以程序会报出异常。</p><p>指针和数字</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">pointer_updates <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0xB8000000</span><span class="token punctuation">;</span><span class="token comment">//第一种</span>
<span class="token comment">//pointer_updates = 0xB8000000;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>C99标准发布之前，第二种C语言是允许这样赋值，但C++会有异常，因为C++类型一致方面要求比较严格，应通过强制转换类型将数字转换为适当的地址类型（第一种）</p><h4 id="使用new-delete来分配和删除内存"><a href="#使用new-delete来分配和删除内存" class="headerlink" title="使用new/delete来分配和删除内存"></a><strong>使用new/delete来分配和删除内存</strong></h4><p>指针真正的用武之地是可以在运行阶段分配未命名的内存以存储值</p><p>new int告诉程序，需要适合存储int的内存。new运算符根据类型来确定需要多少字节的内存。然后它找到这样的内存，并返回其地址</p><ul><li><p>对于指针需要指出的另一点是：<strong>new分配的内存块</strong>通常与<strong>常规变量声明分配的内存块</strong>不同，像values这些的值都存储在栈（stack）的内存区域中，而new在被称为堆（heap）或自由存储区（free store）的内存区域分配内存</p></li><li><p>计算机可能会由于没有足够的内存而无法满足new的请求。C++提供了检测并处理内存分配失败的工具</p></li></ul><p>使用delete释放内存</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">*</span>new_pointer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">;</span>
<span class="token operator">*</span>new_pointer <span class="token operator">=</span> <span class="token number">1001</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span> new_pointer<span class="token punctuation">;</span><span class="token comment">//仅仅释放new_pointer指向的内存，但不会删除指针</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>需要注意的是一定要配对的使用new和delete；不然可能发生内存泄漏（memory leak），被分配的内存再也无法使用了，如果内存泄漏严重，程序会因不断寻找更多内存而终止。</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">delete</span> new_pointer<span class="token punctuation">;</span>
<span class="token keyword">delete</span> new_pointer<span class="token punctuation">;</span><span class="token comment">//not valid</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>delete只能释放使用new分配内存</p><p><strong>使用new来创建动态数组，使用delete[]来删除动态数组</strong></p><p>在编译时给数组分配内存被称为<strong>静态联编</strong>（static binding），意味着数组是在编译时加入到程序中的。但使用new时，如果在运行阶段需要数组，则创建它；如果不需要，则不创建，还可以在程序运行时选择数组的长度。这被称为<strong>动态联编</strong>（dynamic binding）</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span><span class="token operator">*</span> new_pointer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//创建一个包含10个int元素的数组</span>
	<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>new_pointer<span class="token punctuation">;</span><span class="token comment">//动态删除数组</span>
	<span class="token keyword">int</span><span class="token operator">*</span> ze<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">delete</span> ze<span class="token punctuation">;</span><span class="token comment">//对空指针应用delete是安全的</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="使用动态数组"><a href="#使用动态数组" class="headerlink" title="使用动态数组"></a><strong>使用动态数组</strong></h4><p>*(new_pointer+1)等价于new_pointer[1]，相邻的int地址通常相差2个字节或4个字节，所以说指针算术是一个神奇的东西，比如*new_pointer指向一个数组</p><p><code>int old_array[3]={10,2,3};</code></p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/20201007230134651.png"></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">int</span> x<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span><span class="token operator">*</span> x_ptr <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Value of x_ptr = "</span> <span class="token operator">&lt;&lt;</span> x_ptr <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Value of x_ptr + 1 = "</span> <span class="token operator">&lt;&lt;</span> x_ptr <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
	<span class="token keyword">char</span> y<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> y_ptr <span class="token operator">=</span> <span class="token operator">&amp;</span>y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Value of y_ptr = "</span> <span class="token operator">&lt;&lt;</span> y_ptr <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Value of y_ptr + 1 = "</span> <span class="token operator">&lt;&lt;</span> y_ptr <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Output<span class="token operator">:</span> Value of x_ptr <span class="token operator">=</span> <span class="token number">492316</span>
        Value of x_ptr <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">492320</span>
        Value of y_ptr <span class="token operator">=</span> <span class="token number">492303</span>
        Value of y_ptr <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">492304</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="指针和字符串"><a href="#指针和字符串" class="headerlink" title="指针和字符串"></a><strong>指针和字符串</strong></h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token string">"aaa"</span><span class="token punctuation">;</span><span class="token comment">//字符串内存地址" "</span>
	cout <span class="token operator">&lt;&lt;</span> p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">//输出字符串</span>
	cout <span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">//输出字符串地址</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>独立副本</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">char</span> animal<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"abcd"</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> p<span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> q<span class="token punctuation">;</span>
	q <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>animal<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>animal<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	q <span class="token operator">=</span> animal<span class="token punctuation">;</span><span class="token comment">//第一种，修改存储p的地址，使其指向animal</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> animal<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//第二种，第一个参数表示目标地址	</span>
	<span class="token comment">//所以分配了目标地址，p和animal互为独立的副本</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span>animal <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span>q <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="自动存储、静态存储、动态存储"><a href="#自动存储、静态存储、动态存储" class="headerlink" title="自动存储、静态存储、动态存储"></a><strong>自动存储、静态存储、动态存储</strong></h4><p><strong>自动存储</strong></p><p>函数内部定义的常规变量使用自动存储空间，被称为自动变量。在所属函数被调用时自动产生，在该函数结束时消亡</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">getname</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">;</span>
	name <span class="token operator">=</span> <span class="token function">getname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">" at"</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span>name <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
	<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>name<span class="token punctuation">;</span>
	name <span class="token operator">=</span> <span class="token function">getname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">" at"</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span>name <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
	<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>name<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">getname</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> temp<span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter last name:"</span><span class="token punctuation">;</span>
	cin <span class="token operator">&gt;&gt;</span> temp<span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> pn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">strcpy_s</span><span class="token punctuation">(</span>pn<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> pn<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220307180012705.png"></p><p>从上图看，其实C++不保证新释放的内存就是下一次使用new时选择的内存，自动变量通常存储在栈中</p><p><strong>静态存储</strong></p><p>静态存储是整个程序执行期间都存在的存储方式。使变量成为静态的方式有两种：一种是在函数外面定义这个变量，另一种是在声明变量时使用关键字static</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/20201008102156738.png"></p><p>自动存储和静态存储的关键在于：这些方法严格的限制了变量的寿命<br>变量可能存在于程序的整个生命周期（静态变量），也可能只是在特定函数被执行时存在（自动变量）</p><p><strong>动态存储</strong></p><p>new和delete运算符提供了一种比自动变量和静态变量更灵活的方法。他们可以管理一个内存池，这在C++中被称为自由存储区（free store）或堆（heap）。new和delete让你能够在一个函数中分配内存，而在另一个函数释放它，因此数据的生命周期不完全受程序或函数的生存时间控制。使用new和delete让程序员对程序如何使用内存有更大的控制权。</p><h4 id="类型组合"><a href="#类型组合" class="headerlink" title="类型组合"></a><strong>类型组合</strong></h4><p>数组+结构+指针</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">oneman</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> year<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	oneman a<span class="token punctuation">;</span>
	oneman<span class="token operator">*</span> aa <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span>
	aa<span class="token operator">-&gt;</span>year <span class="token operator">=</span> <span class="token number">1999</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token operator">*</span>aa<span class="token punctuation">)</span><span class="token punctuation">.</span>year <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	oneman b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>year <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>b <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span>year <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220307201239288.png"></p><h4 id="指针和const"><a href="#指针和const" class="headerlink" title="指针和const"></a><strong>指针和const</strong></h4><p>可以使用两种不同的方式将const关键字用于指针</p><ul><li>让指针指向一个常量对象，防止使用该指针来修改所指向的值<strong>（值不变）</strong></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> pointer <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span> pt <span class="token operator">=</span> <span class="token operator">&amp;</span>pointer<span class="token punctuation">;</span>
	<span class="token comment">//*pt = 30;这样是错误的，不能动指针</span>
	pointer <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>pt <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220310152419990.png"></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> pointer <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span> pt <span class="token operator">=</span> <span class="token operator">&amp;</span>pointer<span class="token punctuation">;</span>
	pointer <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> p <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>
	pt <span class="token operator">=</span> <span class="token operator">&amp;</span>p<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>pt <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220310152543512.png"></p><p>​ 不能像以下这么赋值</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/20201013212824682.png"></p><p>​ 可以将const变量的地址赋给指向const的指针，但不能将const的地址赋给常规指针</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/2020101409003777.png"></p><p>C++禁止这种行为，其实原因很简单，如果可以将nocon的地址赋给q，则可以用q来修改nocon的值，这使得nocon的const状态很荒谬，因此C++禁止将const的地址赋给非const指针，但是可以使用强制类型转换来突破这种限制</p><ul><li>将指针本身声明为常量，这样可以防止改变指针指向的位置<strong>（地址不变）</strong></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> pointer <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span><span class="token keyword">const</span> pt <span class="token operator">=</span> <span class="token operator">&amp;</span>pointer<span class="token punctuation">;</span>
	<span class="token operator">*</span>pt <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token comment">/*
    int p = 15;
    pt = &amp;p;
    invalid 
    */</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>pt <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220310153141930.png"></p><p><strong>将指针参数声明为指向常量数据的指针有两条理由</strong>：<br>1.这样可以避免由于无意间修改数据而导致的编程错误<br>2.使用const使得函数能够处理const和非const实参，否则将只能接受非const数据<br>如果条件允许，则应将指针形参声明为指向const的指针</p><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><h4 id="解决经典按值传递的例子"><a href="#解决经典按值传递的例子" class="headerlink" title="解决经典按值传递的例子"></a>解决经典<strong>按值传递</strong>的例子</h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">exchange</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	<span class="token function">exchange</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">exchange</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>y<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> temp<span class="token punctuation">;</span>
	temp <span class="token operator">=</span> <span class="token operator">*</span>x<span class="token punctuation">;</span>
	<span class="token operator">*</span>x <span class="token operator">=</span> <span class="token operator">*</span>y<span class="token punctuation">;</span>
	<span class="token operator">*</span>y <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="函数和二维数组"><a href="#函数和二维数组" class="headerlink" title="函数和二维数组"></a>函数和二维数组</h4><p><strong>函数原型定义</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>ar2<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">sum_arr</span><span class="token punctuation">(</span><span class="token keyword">int</span> ar2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>第一种指针参数的声明表示由4个指向int的指针组成的数组</strong>，而不是由一个指向由4个int组成的数组的指针;第二种格式和第一种原型的含义完全相同，但可读性更强</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/20201014104908289.png"></p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/20201014105812628.png"></p><h4 id="函数与array对象"><a href="#函数与array对象" class="headerlink" title="函数与array对象"></a><strong>函数与array对象</strong></h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;array&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> Seasons <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> array<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> Seasons<span class="token operator">&gt;</span> Snames <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Spring"</span><span class="token punctuation">,</span><span class="token string">"Summer"</span><span class="token punctuation">,</span><span class="token string">"Fall"</span><span class="token punctuation">,</span><span class="token string">"Winter"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">fill</span><span class="token punctuation">(</span>array<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token punctuation">,</span> Seasons<span class="token operator">&gt;</span><span class="token operator">*</span> pa<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span>array<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token punctuation">,</span> Seasons<span class="token operator">&gt;</span> da<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	array<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token punctuation">,</span> Seasons<span class="token operator">&gt;</span> expenses<span class="token punctuation">;</span>
	<span class="token function">fill</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>expenses<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">show</span><span class="token punctuation">(</span>expenses<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">fill</span><span class="token punctuation">(</span>array<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token punctuation">,</span> Seasons<span class="token operator">&gt;</span><span class="token operator">*</span> pa<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Seasons<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter:"</span> <span class="token operator">&lt;&lt;</span> Snames<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"expenses:"</span><span class="token punctuation">;</span>
		cin <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span><span class="token operator">*</span>pa<span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span>array<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token punctuation">,</span> Seasons<span class="token operator">&gt;</span> da<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">double</span> total <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\nEXPENSES\n"</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Seasons<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> Snames<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">":$"</span> <span class="token operator">&lt;&lt;</span> da<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		total <span class="token operator">+=</span> da<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Total Expenses:$"</span> <span class="token operator">&lt;&lt;</span> total <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220310160432370.png"></p><h4 id="递归"><a href="#递归" class="headerlink" title="递归"></a><strong>递归</strong></h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;array&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">countdown</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">countdown</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">countdown</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Counting down..."</span> <span class="token operator">&lt;&lt;</span> n <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token function">countdown</span><span class="token punctuation">(</span>n<span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> n <span class="token operator">&lt;&lt;</span> <span class="token string">":Kaboom! "</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以把它理解成函数栈，递归中countdown(0)是栈顶先弹出，以此类推</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220310161042805.png"></p><p><strong>递归-分治法</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;array&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> Len <span class="token operator">=</span> <span class="token number">66</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> Divs <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">subdivide</span><span class="token punctuation">(</span><span class="token keyword">char</span> ar<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> low<span class="token punctuation">,</span> <span class="token keyword">int</span> high<span class="token punctuation">,</span> <span class="token keyword">int</span> level<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">char</span> ruler<span class="token punctuation">[</span>Len<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Len <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		ruler<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">' '</span><span class="token punctuation">;</span>
	ruler<span class="token punctuation">[</span>Len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> max <span class="token operator">=</span> Len <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	ruler<span class="token punctuation">[</span>min<span class="token punctuation">]</span> <span class="token operator">=</span> ruler<span class="token punctuation">[</span>max<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'|'</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> ruler <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> Divs<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">subdivide</span><span class="token punctuation">(</span>ruler<span class="token punctuation">,</span> min<span class="token punctuation">,</span> max<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> ruler <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> Len <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
			ruler<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">' '</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">subdivide</span><span class="token punctuation">(</span><span class="token keyword">char</span> ar<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> low<span class="token punctuation">,</span> <span class="token keyword">int</span> high<span class="token punctuation">,</span> <span class="token keyword">int</span> level<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>level <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>high <span class="token operator">+</span> low<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
	ar<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'|'</span><span class="token punctuation">;</span>
	<span class="token function">subdivide</span><span class="token punctuation">(</span>ar<span class="token punctuation">,</span> low<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> level <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">subdivide</span><span class="token punctuation">(</span>ar<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> high<span class="token punctuation">,</span> level <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220310162653952.png"></p><h4 id="函数指针"><a href="#函数指针" class="headerlink" title="函数指针"></a><strong>函数指针</strong></h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> <span class="token punctuation">(</span><span class="token operator">*</span>pf<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(*pf)是函数，pf是函数指针，表示pf是一个指向函数的指针</span>
<span class="token keyword">double</span> <span class="token operator">*</span><span class="token function">pf</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//而他表示pf是一个返回指针的函数</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>正确声明</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> <span class="token function">pam</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> <span class="token punctuation">(</span><span class="token operator">*</span>pf<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pf <span class="token operator">=</span> pam<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>错误声明</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> <span class="token function">ned</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">ted</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> <span class="token punctuation">(</span><span class="token operator">*</span>pf<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pf <span class="token operator">=</span> ned<span class="token punctuation">;</span><span class="token comment">//invalid</span>
pf <span class="token operator">=</span> ted<span class="token punctuation">;</span><span class="token comment">//invalid</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>函数指针示例</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/2020101710540921.png"></p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/2020101710543839.png"></p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220310163703383.png"></p><p><strong>深入探讨函数指针</strong></p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/20201017105956894.png"></p><p>这些函数的特征标看似不同，但实际上相同</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/20201017110603216.png"></p><p>使用C++的自动类型推断功能时，代码要简单的多</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">auto</span> p2 <span class="token operator">=</span> f2<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>还可以声明包含三个函数指针的数组</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/20201017110954639.png"></p><p>依然可以使用auto</p><h4 id="内联函数"><a href="#内联函数" class="headerlink" title="内联函数"></a><strong>内联函数</strong></h4><p>内联函数是C++为<strong>提高程序运行速度</strong>所做的一项改进。C++内联函数的编译代码与其他程序代码“内联”起来了。也就是说，编译器将使用相应的函数代码替换函数调用。对于内联代码，程序无需跳到另一个位置处执行代码，再跳回来。因此，内联函数的运行速度比常规函数稍快，但<strong>代价是需要占用更多的内存</strong>，如果程序在10个不同的地方调用同一个内联函数，则该程序将包含该函数代码的10个副本</p><p>要使用这项特性，必须采取下述措施：</p><ul><li>在函数声明前加上关键字inline；</li><li>在函数定义前加上关键字inline。</li></ul><p>程序员请求将函数作为内联函数时，编译器不一定会满足这种要求。它可能认为该函数过大或注意到函数调用了自己（内联函数不能递归），因此不能将其作为内联函数；而有些编译器没有启用或实现这种特性。</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">inline</span> <span class="token keyword">double</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220310165907259.png"></p><h4 id="默认参数"><a href="#默认参数" class="headerlink" title="默认参数"></a><strong>默认参数</strong></h4><p>对参数添加默认值必须从右向左</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">harpo</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span><span class="token keyword">int</span> m<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//valid</span>
<span class="token keyword">int</span> <span class="token function">chico</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span><span class="token keyword">int</span> m<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//invalid</span>
<span class="token keyword">int</span> <span class="token function">groucho</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">int</span> m<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//valid</span>

beeps <span class="token operator">=</span> <span class="token function">harpo</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//same as harpo(2,4,5)</span>
beeps <span class="token operator">=</span> <span class="token function">harpo</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// same as harpo(1,8,5)</span>
beeps <span class="token operator">=</span> <span class="token function">harpo</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// no default arguments used</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="函数重载"><a href="#函数重载" class="headerlink" title="函数重载"></a><strong>函数重载</strong></h4><p>术语”多态”指的是有多种形态<br>术语“函数重载”指的是可以有多个同名的函数，我们通常使用函数重载来设计一系列函数-它们完成相同的工作，但使用不同的参数列表</p><p>函数重载的关键是函数的参数列表-也成为函数特征标（function signature），如果两个函数的参数数目和类型相同，同时参数的排列顺序也相同，则它们的特征标相同，而变量名是无关紧要的，C++允许定义名称相同的函数，条件是他们的特征标不同。</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str <span class="token punctuation">,</span><span class="token keyword">int</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">double</span> bd<span class="token punctuation">,</span><span class="token keyword">int</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">long</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span><span class="token keyword">int</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用print()函数时，编译器将根据所采取的用法使用有相应的特征标的原型</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//use #1</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//use #5</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token number">1999.0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//use #2</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token number">1999</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//use #4</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token number">1999L</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//use #3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>但对于下面语句</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">3210</span><span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>print()不与任何原型匹配，但C++会尝试使用标准类型转换强制进行匹配，但上述代码中，有三个将数字作为第一个参数的原型，因此有3种转换year的方式.在这种情况下,C++将拒绝这种调用，并将其视为错误</p><p>一些看起来彼此不同的特征标是不能共存的。例如请看下面的两个原型</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> <span class="token function">cube</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> <span class="token function">cube</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">cout <span class="token operator">&lt;&lt;</span> <span class="token function">cube</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>参数x与double x原型和double &amp;x原型都匹配，因此编译器无法确定究竟应使用哪个原型。为避免这种混乱，编译器在检查函数特征标时，将把类型引用和类型本身视为同一个特征标，所以不会报错</p><p>继续看下面的原型</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">dribble</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> bits<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">dribble</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>cbits<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">dabble</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>bits<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">drivel</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>bits<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>下面列出了各种函数调用对应的原型</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">char</span> p1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"aaa"</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> pw<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"bbb"</span><span class="token punctuation">;</span>
<span class="token function">dribble</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//dribble(const char *);</span>
<span class="token function">dribble</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//dribble(char *);</span>
<span class="token function">dabble</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// no match </span>
<span class="token function">dabble</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//dabble(char *);</span>
<span class="token function">drivel</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// drivel(const char *);</span>
<span class="token function">drivel</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// drivel(const char *);</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>下面两个声明是互斥的</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">long</span> <span class="token function">gronk</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span><span class="token keyword">float</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> <span class="token function">gronk</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span><span class="token keyword">float</span> m<span class="token punctuation">)</span><span class="token operator">:</span><span class="token comment">//not allowed</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>因此，C++不允许以这种方式重载gronk().返回类型可以不同，但特征标也必须不同</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">long</span> <span class="token function">gronk</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span><span class="token keyword">float</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> <span class="token function">gronk</span><span class="token punctuation">(</span><span class="token keyword">float</span> n<span class="token punctuation">,</span><span class="token keyword">float</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//hence allowed</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>重载引用参数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">sink</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">&amp;</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// matches modifiable lvalue</span>
<span class="token keyword">void</span> <span class="token function">sink</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>r2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// matches modifiable or const lvalue,rvalue</span>
<span class="token keyword">void</span> <span class="token function">sink</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">&amp;&amp;</span>r3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//matches rvalue</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">55.5</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> y <span class="token operator">=</span> <span class="token number">30.5</span><span class="token punctuation">;</span>
<span class="token function">sink</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//sink(double &amp;)</span>
<span class="token function">sink</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//sink(const double &amp;)</span>
<span class="token function">sink</span><span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//sink(double &amp;&amp;)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>何时使用函数重载</strong></p><p>虽然函数重载很吸引人，但也不要滥用。仅当函数基本上执行相同的任务，但使用不同形式的数据时，才应采用函数重载。</p><h4 id="名称修饰"><a href="#名称修饰" class="headerlink" title="名称修饰"></a>名称修饰</h4><p>C++如何跟踪每一个重载函数呢？它给这些函数指定了秘密身份。使用C++开发工具中的编辑器编写和编译程序，C++编译器将执行一些神奇的操作-名称修饰（name decoration）或名称矫正（name mangling)，它根据函数原型中指定的形参类型对每个函数名进行加密。请看下述未经修饰的函数原型</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">long</span> <span class="token function">MyFunctionFoo</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这种格式对于人类来说很适合；我们知道函数接受两个参数（一个为int类型，另一个为float类型），并返回一个long值。而编译器将名称转换为不太好看的内部表示，来描述该接口，如下所示</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token operator">?</span>MyFunctionFoo@@YAXH<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>对原始名称进行的表面看来无意义的修饰（或矫正，因人而异）将对参数数目和类型进行编码</p><h4 id="函数模板"><a href="#函数模板" class="headerlink" title="函数模板"></a>函数模板</h4><p>函数模板是通用的函数描述，也就是说，他们使用泛型来定义函数，其中的泛型可用具体的类型（如int和double）替换。由于模板允许以泛型的方式编写程序，因此有时也被称为通用编程</p><p>交换两个数例子</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">AnyType</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>AnyType <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> AnyType <span class="token operator">&amp;</span>b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    AnyType temp<span class="token punctuation">;</span>
    temp <span class="token operator">=</span> a<span class="token punctuation">;</span>
    a <span class="token operator">=</span> b<span class="token punctuation">;</span>
    b <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token function">Swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl
         <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220311214719752.png"></p><p>在标准C++98添加关键字typename之前，C++使用关键字class来创建模板</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">AnyType</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>AnyType <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> AnyType <span class="token operator">&amp;</span>b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    AnyType temp<span class="token punctuation">;</span>
    temp <span class="token operator">=</span> a<span class="token punctuation">;</span>
    a <span class="token operator">=</span> b<span class="token punctuation">;</span>
    b <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>模板重载</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>T<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> T<span class="token operator">&amp;</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>T<span class="token operator">*</span> a<span class="token punctuation">,</span> T<span class="token operator">*</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token function">Swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl
        <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">int</span> c<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> d<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">Swap</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
            cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
            cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>T<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> T<span class="token operator">&amp;</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    T temp<span class="token punctuation">;</span>
    temp <span class="token operator">=</span> a<span class="token punctuation">;</span>
    a <span class="token operator">=</span> b<span class="token punctuation">;</span>
    b <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>T a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> T b<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    T temp<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        temp <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220311220134273.png"></p><p>模板的局限性</p><p>假设有如下模板函数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span>T a<span class="token punctuation">,</span>T b<span class="token punctuation">)</span>
<span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>下面的代码假定定义了赋值，但如果T为数组，这种假设不成立</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">a<span class="token operator">=</span>b<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>同样，下面的语句假设定义了&lt;，但如果T为结构，该假设便不成立</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">&lt;</span>b<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>另外，为数组名定义了运算符&gt;,但由于数组名为地址，因为它比较的是数组的地址，而这可能不是您希望的。下面的语句假定为类型T定义了乘法运算符，但如果T数组、指针或结构，这种假设便不成立</p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">T c = a*b;   <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>显示具体化</strong></p><p>第三代具体化-ISO/ANSI C++标准</p><ul><li><p>对于给定的函数名，可以有非模板函数、模板函数和显示具体化模板函数以及它们的重载版本</p></li><li><p>显式具体化的原型和定义应以template&lt;&gt;打头，并通过名称来指出类型</p></li><li><p>具体化优先于常规模板，而非模板函数优先于具体化和常规模板</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// 非模板函数原型</span>
<span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>job <span class="token operator">&amp;</span><span class="token punctuation">,</span> job <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 常规模板函数原型</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>T <span class="token operator">&amp;</span><span class="token punctuation">,</span> T <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 显示具体化模板函数原型</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token keyword">void</span> <span class="token generic-function"><span class="token function">Swap</span><span class="token generic class-name"><span class="token operator">&lt;</span>job<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>job <span class="token operator">&amp;</span><span class="token punctuation">,</span> job <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>下面举个交换结构的实例来说显式具体化的好处</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>T <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> T <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">job</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> salary<span class="token punctuation">;</span>
    <span class="token keyword">int</span> floor<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token generic-function"><span class="token function">Swap</span><span class="token generic class-name"><span class="token operator">&lt;</span>job<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>job <span class="token operator">&amp;</span>j1<span class="token punctuation">,</span> job <span class="token operator">&amp;</span>j2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span>job <span class="token operator">&amp;</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>

    cout<span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout<span class="token punctuation">.</span><span class="token function">setf</span><span class="token punctuation">(</span>ios<span class="token double-colon punctuation">::</span>fixed<span class="token punctuation">,</span> ios<span class="token double-colon punctuation">::</span>floatfield<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"i ,j = "</span>
         <span class="token operator">&lt;&lt;</span> i
         <span class="token operator">&lt;&lt;</span> <span class="token string">", "</span> <span class="token operator">&lt;&lt;</span> j <span class="token operator">&lt;&lt;</span> <span class="token string">".\n"</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Using compiler-generated int swapper:\n"</span><span class="token punctuation">;</span>
    <span class="token function">Swap</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Now i,j= "</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">", "</span> <span class="token operator">&lt;&lt;</span> j <span class="token operator">&lt;&lt;</span> <span class="token string">".\n"</span><span class="token punctuation">;</span>
    job cue <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"Susan Yaffee"</span><span class="token punctuation">,</span> <span class="token number">73000.60</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    job sidney <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"Sidney Taffee"</span><span class="token punctuation">,</span> <span class="token number">78060.72</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Before job swapping:\n"</span><span class="token punctuation">;</span>
    <span class="token function">show</span><span class="token punctuation">(</span>cue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">show</span><span class="token punctuation">(</span>sidney<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">Swap</span><span class="token punctuation">(</span>cue<span class="token punctuation">,</span> sidney<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"After job swapping:\n"</span><span class="token punctuation">;</span>
    <span class="token function">show</span><span class="token punctuation">(</span>cue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">show</span><span class="token punctuation">(</span>sidney<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>T <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> T <span class="token operator">&amp;</span>b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    T temp<span class="token punctuation">;</span>
    temp <span class="token operator">=</span> a<span class="token punctuation">;</span>
    a <span class="token operator">=</span> b<span class="token punctuation">;</span>
    b <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token generic-function"><span class="token function">Swap</span><span class="token generic class-name"><span class="token operator">&lt;</span>job<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>job <span class="token operator">&amp;</span>j1<span class="token punctuation">,</span> job <span class="token operator">&amp;</span>j2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">double</span> t1<span class="token punctuation">;</span>
    <span class="token keyword">int</span> t2<span class="token punctuation">;</span>
    t1 <span class="token operator">=</span> j1<span class="token punctuation">.</span>salary<span class="token punctuation">;</span>
    j1<span class="token punctuation">.</span>salary <span class="token operator">=</span> j2<span class="token punctuation">.</span>salary<span class="token punctuation">;</span>
    j2<span class="token punctuation">.</span>salary <span class="token operator">=</span> t1<span class="token punctuation">;</span>
    t2 <span class="token operator">=</span> j1<span class="token punctuation">.</span>floor<span class="token punctuation">;</span>
    j1<span class="token punctuation">.</span>floor <span class="token operator">=</span> j2<span class="token punctuation">.</span>floor<span class="token punctuation">;</span>
    j2<span class="token punctuation">.</span>floor <span class="token operator">=</span> t2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span>job <span class="token operator">&amp;</span>j<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> j<span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span> <span class="token string">":$"</span> <span class="token operator">&lt;&lt;</span> j<span class="token punctuation">.</span>salary <span class="token operator">&lt;&lt;</span> <span class="token string">" on floor "</span> <span class="token operator">&lt;&lt;</span> j<span class="token punctuation">.</span>floor <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220312171926429.png"></p></li></ul><p><strong>实例化和具体化</strong></p><p>隐式实例化、显式实例化和显式具体化统称为具体化。它们的相同之处在于，它们表示的都是使用具体类型的函数定义，而不是通用描述</p><p>引入显式实例化后，必须使用新的语法—在声明中使用前缀template和template&lt;&gt;，以区分显式实例化和显式具体化。通常功能越多，语法规则也越多</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>T <span class="token operator">&amp;</span><span class="token punctuation">,</span>T <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token keyword">void</span> <span class="token generic-function"><span class="token function">Swap</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">&amp;</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>

<span class="token keyword">template</span> <span class="token keyword">void</span> <span class="token generic-function"><span class="token function">Swap</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">&amp;</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//显式实例化，并用模板定义来生成Swap()的char版本</span>
<span class="token keyword">short</span> a<span class="token punctuation">,</span>b<span class="token punctuation">;</span>
<span class="token function">Swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
job n<span class="token punctuation">,</span>m<span class="token punctuation">;</span>
<span class="token function">Swap</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> g<span class="token punctuation">,</span>h<span class="token punctuation">;</span>
<span class="token function">Swap</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>编译器选择使用哪个函数版本</strong><br>对于函数重载、函数模板和函数模板重载，C++需要（且有）一个定义良好的策略，来决定为函数调用使用哪一个函数定义，尤其是有多个参数时。这个过程称为重载解析（overloading resolution)</p><ul><li>第一步：创建候选函数列表。其中包含与被调用函数的名称相同的函数和模板函数</li><li>第二步：使用候选函数列表创建可行函数列表。这些都是参数数目正确的函数，为此有一个隐式转换序列，其中包括实参类型与相应的参数类型完全匹配的情况。例如，使用float参数的函数调用可以将参数转换为double,从而与double形参匹配，而模板可以为float生成一个实例</li><li>第三步：确定是否有最佳的可行函数。如果有，则使用它，否则该函数调用出错</li></ul><p>下面的调用</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">may</span><span class="token punctuation">(</span><span class="token char">'B'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>首先，编译器将寻找候选者，即名称为may()的函数和函数模板。然后寻找那些可以用一个参数调用的函数。例如，下面的函数符合要求，因为其名称与被调用的函数相同，且可只给它们传递一个参数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">may</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//#1</span>
<span class="token keyword">float</span> <span class="token function">may</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">,</span><span class="token keyword">float</span> <span class="token operator">=</span><span class="token number">3</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//#2</span>
<span class="token keyword">void</span> <span class="token function">may</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//#3</span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">may</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//#4</span>
<span class="token keyword">char</span> <span class="token function">may</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//#5</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token keyword">void</span> <span class="token function">may</span><span class="token punctuation">(</span><span class="token keyword">const</span> T <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//#6</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token keyword">void</span> <span class="token function">may</span><span class="token punctuation">(</span>T <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//#7 </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>排除#4和#7，剩下5个可行函数，编译器确定哪个是最佳的<br>1.完全匹配，但常规函数优先于模板<br>2.提升转换（例如，char和shorts自动转换为int，float自动转换为double）<br>3.标准转换（例如，int转换为char，long转换为double）<br>4.用户定义的转换，如类声明中定义的转换</p><p>所以函数#3、#5、#6优于函数#1和#2，因为它们都是完全匹配的，#6是函数模板，所以剩下#3,#5，有两个完全匹配是一种错误，这里会生成一条错误消息，该消息是诸如“ambiguous（二义性）”这样的词语<br>但是一个完全匹配优于另一个的另一种情况是，其中一个是非模板函数，而另一个不是。非模板函数将优先于模板函数（包括显式具体化）<br>如果两个完全匹配的函数都是模板函数，则较具体的模板函数优先。</p><p>用于找出最具体的模板的规则被称为<strong>函数模板的部分排序规则（partial ordering rules）</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">ShowArray</span><span class="token punctuation">(</span>T arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">ShowArray</span><span class="token punctuation">(</span>T <span class="token operator">*</span>arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">debts</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> amount<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    <span class="token keyword">int</span> things<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">301</span><span class="token punctuation">,</span> <span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">debts</span> mr_E<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span>
        <span class="token punctuation">{</span>

            <span class="token punctuation">{</span><span class="token string">"Ima WoLfe"</span><span class="token punctuation">,</span> <span class="token number">2400.0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token string">"Ura Foxe"</span><span class="token punctuation">,</span> <span class="token number">1300.0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token string">"Iby Stout"</span><span class="token punctuation">,</span> <span class="token number">1800.0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> <span class="token operator">*</span>pd<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        pd<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>mr_E<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>amount<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Listing Mr.E's counts of things:\n"</span><span class="token punctuation">;</span>
    <span class="token function">ShowArray</span><span class="token punctuation">(</span>things<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Listing Mr.E's debts:\n"</span><span class="token punctuation">;</span>
    <span class="token function">ShowArray</span><span class="token punctuation">(</span>pd<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">ShowArray</span><span class="token punctuation">(</span>T arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Template A\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token char">' '</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">ShowArray</span><span class="token punctuation">(</span>T <span class="token operator">*</span>arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"template B:\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token char">' '</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这两个模板中，第二个模板更具体，因为他做了特定的假设-数组内容是指针，如果取消第二个模板你会发现显示的将是地址</p><p><strong>创建自定义选择</strong><br>在有些情况下，可通过编写合适的函数调用，引导编译器做出您希望的选择</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span> 
T <span class="token function">letter</span><span class="token punctuation">(</span>T a<span class="token punctuation">,</span>T b<span class="token punctuation">)</span><span class="token comment">//#1</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">&lt;</span> b <span class="token operator">?</span> a <span class="token operator">:</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">letter</span> <span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token comment">//#2</span>
<span class="token punctuation">{</span>
    a <span class="token operator">=</span> a <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">-</span>a <span class="token operator">:</span> a<span class="token punctuation">;</span>
    b <span class="token operator">=</span> b <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">-</span>b <span class="token operator">:</span> b<span class="token punctuation">;</span>
    <span class="token keyword">return</span> a <span class="token operator">&lt;</span> b <span class="token operator">?</span> a <span class="token operator">:</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">15.5</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> y <span class="token operator">=</span> <span class="token number">25.9</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token function">letter</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">//USE #2</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token function">letter</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">//USE #1 WITH DOUBLE</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token generic-function"><span class="token function">letter</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">//USE #1 WITH INT</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token generic-function"><span class="token function">letter</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">//USE #1 WITH INT</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220312182647430.png" alt="image-20220312182647430"></p><p><strong>模板函数的发展</strong></p><p>在C++98时编写模板函数时会有下面那种想法</p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">template&lt;class T1,class T2&gt;
void fd(T1 x,T2 y)
{
...
?type?xpy = x+y;
...
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>xpy应为什么类型呢？由于不知道ft()将如何使用，因此无法预先知道这一点。正确的类型 可能是T1、T2或其他类型。例如,T1可能是double类型，而T2可能是int，在这种情况下，两个变量的和将为double类型。T1可能是short，而T2可能是int，在这种情况下，两个变量的和为int类型。T1还可能是short，而T2可能是char，在这种情况下，加法运算将导致自动整型提升，因此结果类型为int，另外，结构和类可能重载运算符+，这导致问题更加复杂.因此，在C++98中，没有办法声明xpy的类型</p><p><strong>关键字decltype(C++11)</strong></p><p>C++11新增的关键字decltype提供了解决方案</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> x<span class="token punctuation">;</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> y<span class="token punctuation">;</span><span class="token comment">//make y the same type as x </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>给decltype提供的参数可以是表达式，因此在前面的模板函数fd()中，可使用下面的代码</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">decltype</span><span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span> xpy<span class="token punctuation">;</span><span class="token comment">//make xpy the same type as x + y</span>
xpy <span class="token operator">=</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>另一种方法是，将这两条语句合而为一</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">decltype</span><span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span> xpy <span class="token operator">=</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>因此C++98的想法可得以实现</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T1</span><span class="token punctuation">,</span><span class="token keyword">class</span> <span class="token class-name">T2</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">ft</span><span class="token punctuation">(</span>T1 x<span class="token punctuation">,</span>T2 y<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span> xpy <span class="token operator">=</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>为确定类型，编译器必须遍历一遍核对表</strong><br>假设有如下声明</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">decltype</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span> var<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>则核对表的简化版如下</p><p>第一步：如果expression是一个没有用括号括起的标识符，则var的类型与该标识符的类型相同，包括const等限定符</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">5.5</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> y <span class="token operator">=</span> <span class="token number">7.9</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> <span class="token operator">&amp;</span>rx <span class="token operator">=</span> x<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">*</span>pd<span class="token punctuation">;</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> w<span class="token punctuation">;</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span>rx<span class="token punctuation">)</span> u <span class="token operator">=</span> y<span class="token punctuation">;</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span>pd<span class="token punctuation">)</span> v<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第二步：如果expression是一个函数调用，则var的类型与函数的返回类型相同</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">long</span> <span class="token function">indeed</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span><span class="token function">indeed</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> m<span class="token punctuation">;</span><span class="token comment">//m is type list </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>第三步：如果expression是一个左值，则var为指向其类型的引用。这好像意味着前面的w为引用类型，因为x是一个左值。但别忘了，这种情况已经在第一步处理过了。要进入第三步，expression不能是未用括号括起的标识符，那么，expression是什么时将进入第三步呢？一种显而易见的情况是，expression使用括号括起的标识符</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> xx <span class="token operator">=</span> <span class="token number">4.4</span><span class="token punctuation">;</span>
<span class="token keyword">decltype</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>xx<span class="token punctuation">)</span><span class="token punctuation">)</span> r2 <span class="token operator">=</span> xx<span class="token punctuation">;</span><span class="token comment">//r2 is double &amp;</span>
<span class="token keyword">decltype</span> <span class="token punctuation">(</span>xx<span class="token punctuation">)</span> w <span class="token operator">=</span> xx<span class="token punctuation">;</span><span class="token comment">// w is double </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>括号不会改变表达式的值和左值性。下面两条语句等效</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">xx <span class="token operator">=</span> <span class="token number">98.6</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>xx<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">98.6</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>第四步：如果前面的条件都不满足，则var的类型与expression的类型相同</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">&amp;</span>k <span class="token operator">=</span> j<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">&amp;</span>n <span class="token operator">=</span> j<span class="token punctuation">;</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">)</span> i1<span class="token punctuation">;</span><span class="token comment">//i1 type int </span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span><span class="token number">100L</span><span class="token punctuation">)</span> i2<span class="token punctuation">;</span><span class="token comment">// i2 type long</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span>k<span class="token operator">+</span>n<span class="token punctuation">)</span> i3<span class="token punctuation">;</span><span class="token comment">// i3 type int</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>请注意，虽然k和n都是引用，但表达式k+n不是引用：它是两个int的和，因此类型为int</p><p>如果需要多次声明，可结合使用typedef和decltype</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T1</span><span class="token punctuation">,</span><span class="token keyword">class</span> <span class="token class-name">T2</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">ft</span><span class="token punctuation">(</span>T1 x<span class="token punctuation">,</span>T2 y<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">typedef</span> <span class="token keyword">decltype</span><span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span> xtype<span class="token punctuation">;</span>
xtype xpy <span class="token operator">=</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span>
xytype arr<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
xytype <span class="token operator">&amp;</span>rxy <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//rxy a reference</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>另一种函数声明语法(C++11后置返回类型）</p><p>有一个相关的问题是decltype 本身无法解决的</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T1</span><span class="token punctuation">,</span><span class="token keyword">class</span> <span class="token class-name">T2</span><span class="token operator">&gt;</span>
<span class="token operator">?</span>type<span class="token operator">?</span> <span class="token function">gt</span> <span class="token punctuation">(</span>T1 x<span class="token punctuation">,</span>T2 y<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">return</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>无法预先知道将x和y相加得到的类型。好像可以将返回类型设置为decltype(x+y)，但不幸的是，此时还未声明参数x和y，它们不在作用域内</p><p>但C++新增了一种声明和定义函数的语法</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">float</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>使用新增的语法可编写成这样</p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">auto h(int x,float y)-&gt;double;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这将返回类型移到了参数声明后面。-&gt;double 被称为后置返回类型(trailing return type)。其中auto是一个占位符，表示后置返回类型提供的类型，这是C++11给auto新增的一种角色</p><p>通过结合使用这种语法和decltype，便可给gt()指定返回类型</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T1</span><span class="token punctuation">,</span><span class="token keyword">class</span> <span class="token class-name">T2</span><span class="token operator">&gt;</span>
<span class="token keyword">auto</span> <span class="token function">gt</span><span class="token punctuation">(</span>T1 x<span class="token punctuation">,</span>T2 y<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">return</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>decltype在参数声明后面，因此x和y位于作用域内，可以使用它们</p><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><h4 id="引用变量"><a href="#引用变量" class="headerlink" title="引用变量"></a>引用变量</h4><p>C和C++使用&amp;符号来指示变量的地址。C++给&amp;符号赋予了另一个含义，将其用来声明引用。例如rodents作为rats变量的别名</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> rats<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">&amp;</span>rodents <span class="token operator">=</span> rats<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>这里&amp;不是地址运算符,int&amp;指的是指向int的引用，上述引用声明允许将rats和rodents互换-他们指向相同的值和内存单元</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> rats <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span><span class="token operator">&amp;</span> rodents <span class="token operator">=</span> rats<span class="token punctuation">;</span>
	<span class="token keyword">int</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token operator">&amp;</span>rats<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> rats <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> rodents <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	rodents<span class="token operator">++</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>rats <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>rodents <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> rats <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220310171957752.png"></p><p>引用看起来很像指针，但除了表示不同，还有就是必须是声明引用时，将其初始化，而不像指针那样，可以先声明在赋值</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> rat<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">&amp;</span>rodent<span class="token punctuation">;</span><span class="token comment">//invalid</span>
rodent <span class="token operator">=</span> rat<span class="token punctuation">;</span><span class="token comment">//invalid</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>引用更接近const指针，必须在创建时进行初始化</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">&amp;</span>rodents <span class="token operator">=</span> rat
<span class="token comment">//实际上是下述代码的伪装表示</span>
<span class="token keyword">int</span> <span class="token operator">*</span><span class="token keyword">const</span> pr <span class="token operator">=</span> <span class="token operator">&amp;</span>rats<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> rats <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span><span class="token operator">&amp;</span> rodents <span class="token operator">=</span> rats<span class="token punctuation">;</span>
	<span class="token keyword">int</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token operator">&amp;</span>rats<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> rats <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> rodents <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mouse <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
	rats <span class="token operator">=</span> mouse<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>mouse <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>rats <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>rodents <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> rats <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220310173334449.png"></p><p>值变了，但rodents地址和mouse不相同</p><h4 id="将引用用作函数参数"><a href="#将引用用作函数参数" class="headerlink" title="将引用用作函数参数"></a><strong>将引用用作函数参数</strong></h4><p>这种传递参数的方法称为引用传递按引用传递。允许被调用的函数能够访问调用函数中的变量。C++新增的这项特性是对<strong>C语言的超越</strong>，C语言只能按值传递，按值传递导致被调用函数使用调用程序的值的拷贝。当然C语言也允许避开按值传递的限制，采用按指针传递的方式</p><p>依旧是以<strong>交换两个变量</strong>的值做例子</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> <span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> temp<span class="token punctuation">;</span>
	temp <span class="token operator">=</span> a<span class="token punctuation">;</span>
	a <span class="token operator">=</span> b<span class="token punctuation">;</span>
	b <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220310175256100.png"></p><h4 id="左值"><a href="#左值" class="headerlink" title="左值"></a><strong>左值</strong></h4><p><strong>左值</strong>：左值参数是可被引用的数据对象，例如，变量、数组元素、结构成员、引用和解除引用的指针都是左值。在C语言中，左值最初指的是可出现在赋值语句左边的实体，但这是引入关键字const之前的情况。现在常规变量和const变量都可被视为左值，因为可通过地址访问它们。但常规变量属于可修改的左值，而const变量属于不可修改的左值</p><p><strong>应尽可能使用const</strong><br>将引用参数声明为常数数据的引用的理由有三个：<br>⭐ 使用const可以避免无意中修改数据的编程错误<br>⭐ 使用const使函数能够处理const 和 非 const 实参，否则将只能接受非const数据<br>⭐ 使用const 引用使函数能够正确生成并使用临时变量</p><h4 id="右值"><a href="#右值" class="headerlink" title="右值"></a>右值</h4><p>C++11新增了另一种引用-右值引用(rvalue reference).这种引用可指向右值，是使用&amp;&amp;声明的</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">double</span>  <span class="token operator">&amp;&amp;</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220310181325457.png"></p><p>新增右值引用的主要目的是，让库设计人员能够提供有些操作的更有效的实现</p><p>将引用用于结构</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">struct</span> <span class="token class-name">free_throws</span>
<span class="token punctuation">{</span>
    std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">;</span>
    <span class="token keyword">int</span> made<span class="token punctuation">;</span>
    <span class="token keyword">int</span> attempts<span class="token punctuation">;</span>
    <span class="token keyword">float</span> percent<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token keyword">const</span> free_throws<span class="token operator">&amp;</span> ft<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">set_pc</span><span class="token punctuation">(</span>free_throws<span class="token operator">&amp;</span> ft<span class="token punctuation">)</span><span class="token punctuation">;</span>
free_throws<span class="token operator">&amp;</span> <span class="token function">accumulate</span><span class="token punctuation">(</span>free_throws<span class="token operator">&amp;</span> target<span class="token punctuation">,</span> <span class="token keyword">const</span> free_throws<span class="token operator">&amp;</span> source<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    free_throws one <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"zhoumouren"</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    free_throws two <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"caimouren "</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">16</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    free_throws three <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Minnie Max"</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    free_throws four <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"whily Looper"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    free_throws five <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Long long"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">14</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    free_throws team <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Throwgood"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    free_throws dup<span class="token punctuation">;</span>
    <span class="token function">set_pc</span><span class="token punctuation">(</span>one<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">display</span><span class="token punctuation">(</span>one<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">accumulate</span><span class="token punctuation">(</span>team<span class="token punctuation">,</span> two<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">display</span><span class="token punctuation">(</span>team<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">display</span><span class="token punctuation">(</span><span class="token function">accumulate</span><span class="token punctuation">(</span>team<span class="token punctuation">,</span> three<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">display</span><span class="token punctuation">(</span>team<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dup <span class="token operator">=</span> <span class="token function">accumulate</span><span class="token punctuation">(</span>team<span class="token punctuation">,</span> five<span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Displaying team:\n"</span><span class="token punctuation">;</span>
    <span class="token function">display</span><span class="token punctuation">(</span>team<span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Displaying dup after assignment:\n"</span><span class="token punctuation">;</span>
    <span class="token function">display</span><span class="token punctuation">(</span>dup<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">set_pc</span><span class="token punctuation">(</span>four<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">accumulate</span><span class="token punctuation">(</span>dup<span class="token punctuation">,</span> five<span class="token punctuation">)</span> <span class="token operator">=</span> four<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Displaying dup after ill-advised assignment:\n"</span><span class="token punctuation">;</span>
    <span class="token function">display</span><span class="token punctuation">(</span>dup<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token keyword">const</span> free_throws<span class="token operator">&amp;</span> ft<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Name: "</span> <span class="token operator">&lt;&lt;</span> ft<span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">" Made:"</span> <span class="token operator">&lt;&lt;</span> ft<span class="token punctuation">.</span>made <span class="token operator">&lt;&lt;</span> <span class="token char">'\t'</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Attempts:"</span> <span class="token operator">&lt;&lt;</span> ft<span class="token punctuation">.</span>attempts <span class="token operator">&lt;&lt;</span> <span class="token char">'\t'</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Percent"</span> <span class="token operator">&lt;&lt;</span> ft<span class="token punctuation">.</span>percent <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">set_pc</span><span class="token punctuation">(</span>free_throws<span class="token operator">&amp;</span> ft<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ft<span class="token punctuation">.</span>attempts <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        ft<span class="token punctuation">.</span>percent <span class="token operator">=</span> <span class="token number">100.0f</span> <span class="token operator">*</span> <span class="token keyword">float</span><span class="token punctuation">(</span>ft<span class="token punctuation">.</span>made<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">float</span><span class="token punctuation">(</span>ft<span class="token punctuation">.</span>attempts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>

        ft<span class="token punctuation">.</span>percent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

free_throws<span class="token operator">&amp;</span> <span class="token function">accumulate</span><span class="token punctuation">(</span>free_throws<span class="token operator">&amp;</span> target<span class="token punctuation">,</span> <span class="token keyword">const</span> free_throws<span class="token operator">&amp;</span> source<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    target<span class="token punctuation">.</span>attempts <span class="token operator">+=</span> source<span class="token punctuation">.</span>attempts<span class="token punctuation">;</span>
    target<span class="token punctuation">.</span>made <span class="token operator">+=</span> source<span class="token punctuation">.</span>made<span class="token punctuation">;</span>
    <span class="token function">set_pc</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> target<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="为何要返回引用"><a href="#为何要返回引用" class="headerlink" title="为何要返回引用"></a><strong>为何要返回引用</strong></h4><p>先看下面一段代码</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> m <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">16.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cout <span class="token operator">&lt;&lt;</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">25.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>在第一条语句中，值4.0被复制到一个临时位置，然后被复制给m。第二条语句，值5.0被复制到一个临时位置，然后传递给<strong>cout</strong></p><p>再来看下面一条语句</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">dup <span class="token operator">=</span> <span class="token function">accumulate</span><span class="token punctuation">(</span>team<span class="token punctuation">,</span>five<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>如果accumulate()返回一个结构，而不是指向结构的引用，将把整个结构复制到一个临时位置，再将这个拷贝复制给dup。但在这返回值为引用时，将直接把team复制到dup上，其效率更高</strong></p><h4 id="何时使用引用参数"><a href="#何时使用引用参数" class="headerlink" title="何时使用引用参数"></a><strong>何时使用引用参数</strong></h4><ul><li>程序员能够修改调用函数中的数据对象</li><li>通过传递引用而不是整个数据对象，可以提高程序的运行速度</li></ul><p><strong>什么时候应使用引用、什么时候应使用指针呢？什么时候应按值传递呢？下面是一些指导原则</strong><br>对于使用传递的值而不作修改的函数</p><ul><li>如果数据对象很小，如内置数据类型或小型结构，则按值传递</li><li>如果数据对象是数组，则使用指针，因为这是唯一的选择，并将指针声明为指向const的指针</li><li>如果数据对象是较大的结构，则使用const指针或const引用，以提高程序的效率.这样可以节省复制结构所需的时间和空间</li><li>如果数据对象是类对象，则使用const引用。类设计的语义常常要求使用引用，这是C++新增这项特性的主要原因。因此传递类对象参数的标准方式是按引用传递</li></ul><p>对于修改函数中数据的函数</p><ul><li>如果数据对象是内置数据类型，则使用指针。如果看到诸如fixit（&amp;x)这样的代码（其中x是int），则很明显，该函数将修改x</li><li>如果数据对象是数组，则只能使用指针</li><li>如果数据对象是结构，则使用引用或指针</li><li>如果数据对象是类对象，则使用引用</li></ul><p><strong>当然这只是一些指导原则，很可能有充分的理由做出其他的选择</strong></p><h3 id="内存模型和名称空间"><a href="#内存模型和名称空间" class="headerlink" title="内存模型和名称空间"></a>内存模型和名称空间</h3><h4 id="单独编译"><a href="#单独编译" class="headerlink" title="单独编译"></a>单独编译</h4><p>C++鼓励程序员将组件函数放在独立的文件，可以单独编译这些文件，然后将它们链接成可执行的程序（通常C++编译器既编译程序，也管理链接器）如果只修改了一个文件，则可以只重新编译该文件，然后将它与其他文件的编译版本链接，这会使得大程序的管理更便捷。大多数C++环境都提供了其他工具来帮助管理，unix和linux系统都具有make程序，而windows也有相应的CMake程序</p><p><strong>原来的程序可以分为三部分</strong><br>头文件：包含结构声明和使用这些结构的函数的原型<br>源代码文件：包含与结构相关的函数的代码<br>源代码文件：包含调用与结构相关的函数的代码</p><p><strong>头文件中常包含的内容</strong>：<br>⭐函数原型<br>⭐使用#define或const定义的符号常量<br>⭐结构声明<br>⭐类声明<br>⭐模板声明<br>⭐内联函数</p><p><strong>头文件管理</strong><br>在同一个文件中只能将同一个文件包含一次，记住这个规则很容易，但很可能在不知情的情况下将头文件包含多次，但有一种C/C++技术可以避免多次包含同一个头文件。它是基于预处理器编译指令#ifndef(即if not defined)的</p><p><strong>coordin.h:</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">COORDIN_H_</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">COORDIN_H_</span></span>
<span class="token keyword">struct</span> <span class="token class-name">polar</span>
<span class="token punctuation">{</span>
    <span class="token keyword">double</span> distance<span class="token punctuation">;</span>
    <span class="token keyword">double</span> angle<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">rect</span>
<span class="token punctuation">{</span>
    <span class="token keyword">double</span> x<span class="token punctuation">;</span>
    <span class="token keyword">double</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

polar <span class="token function">rect_to_polar</span><span class="token punctuation">(</span>rect xypos<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">show_polar</span><span class="token punctuation">(</span>polar dapos<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这种情况下，编译器将查看 #ifndef和#endif之间的内容，并读取定义COORDIN_H_的一行。如果在同一个文件中遇到其他包含coordin.h的代码，编译器将知道COORDIN_H_已经被定义了，从而跳到#endfif后面的一行上。这种方法并不能防止编译器将文件包含两次，而只是让它忽略除第一次包含之外的所有内容</p><p><strong>file1.cpp：</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"coordin.h"</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    rect rplace<span class="token punctuation">;</span>
    polar pplace<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter the x and y values: "</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">&gt;&gt;</span> rplace<span class="token punctuation">.</span>x <span class="token operator">&gt;&gt;</span> rplace<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        pplace <span class="token operator">=</span> <span class="token function">rect_to_polar</span><span class="token punctuation">(</span>rplace<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">show_polar</span><span class="token punctuation">(</span>pplace<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Next two numbers (q to quit): "</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bye!\n"</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>file2.cpp:</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cmath&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"coordin.h"</span></span>
polar <span class="token function">rect_to_polar</span><span class="token punctuation">(</span>rect xypos<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    polar answer<span class="token punctuation">;</span>
    answer<span class="token punctuation">.</span>distance <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>xypos<span class="token punctuation">.</span>x <span class="token operator">*</span> xypos<span class="token punctuation">.</span>x <span class="token operator">+</span> xypos<span class="token punctuation">.</span>y <span class="token operator">*</span> xypos<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    answer<span class="token punctuation">.</span>angle <span class="token operator">=</span> <span class="token function">atan2</span><span class="token punctuation">(</span>xypos<span class="token punctuation">.</span>y<span class="token punctuation">,</span> xypos<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> answer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">show_polar</span><span class="token punctuation">(</span>polar dapos<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">double</span> Rad_to_deg <span class="token operator">=</span> <span class="token number">57.29577951</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"distance = "</span> <span class="token operator">&lt;&lt;</span> dapos<span class="token punctuation">.</span>distance<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">",angle = "</span> <span class="token operator">&lt;&lt;</span> dapos<span class="token punctuation">.</span>angle <span class="token operator">*</span> Rad_to_deg<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">" degrees\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>将这两个源代码文件和新的头文件一起进行编译和链接，将生成一个可执行程序</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220312195328025.png"></p><p>可执行文件</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220312200006937.png"></p><p>控制台窗口</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220312195748836.png" alt="image-20220312195748836"></p><h4 id="多个库的链接"><a href="#多个库的链接" class="headerlink" title="多个库的链接"></a><strong>多个库的链接</strong></h4><p>C++标准允许每个编译器设计人员以他认为合适的方式实现名称修饰，因此由不同编译器创建的二进制模块（对象代码文件）很可能无法正确地链接。也就是说两个编译器将为同一个函数生成不同的修饰名称。名称的不同将使链接器无法将一个编译器生成的函数调用与另一个编译器生成的函数定义匹配。在链接编译模块时，请确保所有对象文件或库都是由一个编译器生成的。如果有源代码，通常可以用自己的编译器重新编译源代码来消除链接错误</p><h4 id="存储持续性、作用域和链接性"><a href="#存储持续性、作用域和链接性" class="headerlink" title="存储持续性、作用域和链接性"></a><strong>存储持续性、作用域和链接性</strong></h4><p><strong>自动存储持续性</strong></p><p>在<strong>①函数定义中声明的变量</strong>（包括函数参数)的存储持续性为自动的。它们在程序开始执行其所属的函数或代码块时被创建，在执行完函数或代码块时，它们使用的内存被释放。C++有两种存储持续性为自动的变量</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    <span class="token keyword">int</span> tea <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> tea <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> tea <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> tea <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220316195346753.png"></p><p>第一个tea进入内部代码块时被一个更新的tea定义代替，这两个变量的地址不同，新的tea的内存在程序离开代码块时被释放，然后一开始tea再次被可见</p><p><strong>②寄存器变量</strong></p><p>关键字register最初是由C语言引入的，它建议编译器使用CPU寄存器来存储自动变量</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">register int count_fast;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这旨在提高访问变量速度</p><p>但在C++11中，关键字register只是显式地指出变量是自动的。使用它的唯一原因是，指出程序员想使用一个自动变量，这个变量的名称可能与外部变量相同。保留关键字register的重要原因是，避免了使用该关键字的现有代码非法。</p><p><strong>静态存储持续性</strong></p><p>在函数定义外定义的变量和使用关键字static定义的变量的存储持续性都为静态。它们在程序整个运行过程中都存在。C++有3种存储持续性为静态的变量。</p><p>和C语言一样，C++也为静态存储持续性变量提供了3种链接性：外部链接性（可在其他文件中访问）、内部链接性（只能在当前文件中访问）和无链接性（只能在当前函数或代码块中访问），在默认情况下，静态数组和结构将每个元素或成员的所有位都设置为0</p><p>count和lima不同的是，即使在funct1()函数没有被执行时，count也留在内存中<br>global和one_file的作用域都为整个文件，由于one_file的链接性为内部，因此只能在包含上述代码的文件中使用它；由于global的链接性为外部，因此可以在程序的其他文件中使用它<br>所有的静态持续变量都有初始化特征：未被初始化的静态变量的所有位都被设置为0。这种变量被称为<strong>零初始化的（zero-initialized）</strong></p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/20201029185313753.png"></p><p>如果要在多个文件中使用外部变量，只需在一个文件中包含该变量的定义（单定义规则（One Definition Rule，ODR），但在使用该变量的其他所有文件中，都必须使用关键字extern来声明，<strong>示例（静态持续性、外部链接性）</strong></p><p><strong>external.cpp</strong>（定义变量）</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">double</span> warming <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">double</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">local</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Global warming is "</span> <span class="token operator">&lt;&lt;</span> warming <span class="token operator">&lt;&lt;</span> <span class="token string">" degree.\n"</span><span class="token punctuation">;</span>
    <span class="token function">update</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Global warming is "</span> <span class="token operator">&lt;&lt;</span> warming <span class="token operator">&lt;&lt;</span> <span class="token string">" degrees.\n"</span><span class="token punctuation">;</span>
    <span class="token function">local</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Global warming is "</span> <span class="token operator">&lt;&lt;</span> warming <span class="token operator">&lt;&lt;</span> <span class="token string">" degrees.\n"</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>support.cpp</strong>（使用变量）</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">extern</span> <span class="token keyword">double</span> warming<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">double</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">local</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">double</span> dt<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token comment">//extern double warming;</span>
    warming <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Updating global warming to"</span> <span class="token operator">&lt;&lt;</span> warming<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">" degrees.\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">local</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">double</span> warming <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Local warming ="</span> <span class="token operator">&lt;&lt;</span> warming <span class="token operator">&lt;&lt;</span> <span class="token string">" degrees.\n"</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"But global warming = "</span> <span class="token operator">&lt;&lt;</span> <span class="token double-colon punctuation">::</span>warming<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">" degrees.\n"</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220316214513824.png"></p><p>C++比C语言更进了一步——它提供了作用域解析运算符（::)，放在变量名前面时，该运算符表示使用变量的全局版本</p><p>下面来看另外一个示例</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//file1</span>
<span class="token keyword">int</span> errors <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">//file2</span>
<span class="token keyword">int</span> errors <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">froobish</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
cout <span class="token operator">&lt;&lt;</span> errors<span class="token punctuation">;</span><span class="token comment">//fails</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这种做法将失败，因为它违反了单定义规则，file2中的定义试图创建一个外部变量，因此程序将包含errors的两个定义，这是错误。但如果文件定义了一个静态外部变量，其名称与另一个文件中声明的常规外部变量相同，则在该文件中，静态变量将隐藏常规外部变量</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//file1</span>
<span class="token keyword">int</span> errors <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token comment">//file2</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> errors <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">froobish</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
cout <span class="token operator">&lt;&lt;</span> errors<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这没有违反单定义规则，因为关键字static指出标识符errors的链接性为内部，因此并非要提供外部定义，下面有个静态持续性、内部链接性的例子</p><p><strong>file1.cpp</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">int</span> tom <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> dick <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> harry <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">remote_access</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"main() reports the following addresses:\n"</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>tom <span class="token operator">&lt;&lt;</span> <span class="token string">"= &amp;tom ,"</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>dick <span class="token operator">&lt;&lt;</span> <span class="token string">"=&amp;dick, "</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>harry <span class="token operator">&lt;&lt;</span> <span class="token string">" = &amp;harry\n"</span><span class="token punctuation">;</span>
    <span class="token function">remote_access</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>file2.cpp</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> tom<span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> dick <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> harry <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">remote_access</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"remote_access() reports the following addresses:\n "</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>tom <span class="token operator">&lt;&lt;</span> <span class="token string">"= &amp;tom, "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>dick <span class="token operator">&lt;&lt;</span> <span class="token string">" = &amp;dick, "</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>harry <span class="token operator">&lt;&lt;</span> <span class="token string">" = &amp;harry\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220317174041826.png"></p><p>从上述地址可知，这两个文件使用了同一个变量，但使用了不同的dick和harry变量。具体的地址和格式可能随系统而异，但两个tom变量的地址将相同，而两个dick和harry变量的地址不同</p><p><strong>静态存储持续性、无链接性</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">const</span> <span class="token keyword">int</span> ArSize <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">strcount</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    <span class="token keyword">char</span> input<span class="token punctuation">[</span>ArSize<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> next<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter a line:\n"</span><span class="token punctuation">;</span>
    cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> ArSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>cin<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>next <span class="token operator">!=</span> <span class="token char">'\n'</span><span class="token punctuation">)</span>
            cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">strcount</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter next line (empty line to quit):\n"</span><span class="token punctuation">;</span>
        cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> ArSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bye\n"</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">strcount</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\""</span> <span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> <span class="token string">"\" contains"</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>str<span class="token operator">++</span><span class="token punctuation">)</span>
        count<span class="token operator">++</span><span class="token punctuation">;</span>
    total <span class="token operator">+=</span> count
    cout <span class="token operator">&lt;&lt;</span> count <span class="token operator">&lt;&lt;</span> <span class="token string">" characters\n"</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> total <span class="token operator">&lt;&lt;</span> <span class="token string">" characters\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220317175145562.png"></p><p>静态变量total只在程序运行时被设置为0，以后在两次函数调用之间，其值将保持不变，因此能够记录读取的字符总数</p><p>⭐<strong>线程存储持续性（C++11）</strong>：当前，多核处理器很常见，这些CPU可同时处理多个执行任务。这让程序能够将计算放在可并行处理的不同线程中。如果变量是使用关键字thread_local声明的，则其生命周期与所属的线程一样长</p><p>⭐<strong>动态存储持续性</strong>：用new运算符分配的内存将一直存在，直到使用delete运算符将其释放或程序结束为止。这种内存的存储持续性为动态，有时被称为自由存储(free store）或堆（heap）</p><p>⭐<strong>链接性（linkage）</strong>：描述了名称如何在不同单元间共享。链接性在外部的名称可在文件间共享，链接性为内部的名称只能由一个文件中的函数共享。自动变量的名称没有链接性，因为它们不能共享</p><h4 id="说明符和限定符"><a href="#说明符和限定符" class="headerlink" title="说明符和限定符"></a><strong>说明符和限定符</strong></h4><p><strong>说明符</strong></p><p>auto：自动类型判断<br>register：显式的指出变量是自动变量<br>static：表示静态<br>extern：引用外部变量声明<br>thread_local（C++11）：指出变量的持续性与所属的线程持续性相同<br>mutable(可变的):根据const例子来解释</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">data</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> a<span class="token punctuation">;</span>
    <span class="token keyword">mutable</span> <span class="token keyword">int</span> acc<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">const</span> data veep <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"zhou"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">//strcpy(veep.name,"Joye");错误语句不允许修改name的值</span>
    <span class="token comment">//veep.a = 5;错误语句不允许修改a的值</span>
    veep<span class="token punctuation">.</span>acc <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//true</span>
    cout <span class="token operator">&lt;&lt;</span> veep<span class="token punctuation">.</span>acc <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220317181811392.png"></p><p>使用mutable说明符能使得acc不受这种限制</p><p><strong>cv限定符</strong></p><p>const：内存被初始化后，程序便不能再对它进行修改</p><p>volatile：即使程序代码没有对内存单元进行修改，其值可能发生变化，该关键字的作用是为了改善编译器的优化能力。例如，假设编译器发现，程序在几条语句中两次使用了某个变量的值，则编译器可能不是让程序查找这个值两次，而是将这个值缓存到寄存器中。这种优化假设变量在这两次使用之间不会发生变化，如果不将变量声明为volatile，则编译器将进行这种优化；将变量声明为volatile，相当于告诉编译器，不要进行这种优化</p><p><strong>函数和链接性</strong></p><p>所有函数的存储持续性都自动为静态的，即在整个程序执行期间都一直存在。默认情况下，函数的链接性为外部的，即可以在文件间共享。可以使用static将函数的链接性设置为内部的，使之只能在一个文件中使用</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token keyword">private</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token keyword">private</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这意味着该函数只在这个文件中可见，也可以在其他文件定义同名函数，静态函数会覆盖外部定义</p><h4 id="语言链接性"><a href="#语言链接性" class="headerlink" title="语言链接性"></a>语言链接性</h4><p>C语言中，一个名称只对应一个函数，因此这很容易实现。为满足内部需要，C语言编译器可能将spiff这样的函数名翻译为_spiff。这种方法被称为<strong>C语言链接性（C language linkage）</strong>。C++中，同一个名称可能对应多个函数，必须将这些函数翻译为不同的符号名称。因此，C++编译器执行名称矫正或名称修饰，为重载函数生成不同的符号名称。例如可能将spiff(int)转换为_spoff_i，而将spiff(double,double)转换为_spiff_d_d。这种方法被称为<strong>C++语言链接（C++ language linkage)</strong></p><p>但如果C++程序中使用C库中预编译的函数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">spiff</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>C库文件中的符号名称为_spiff，但对于假设的链接程序来说，C++查询约定是查找符号名称_spiff_i,可以使用函数原型来指出要使用的约定：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">extern</span> <span class="token string">"C"</span> <span class="token keyword">void</span> <span class="token function">spiff</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">extern</span> <span class="token keyword">void</span> <span class="token function">spoff</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">extern</span> <span class="token string">"C++"</span> <span class="token keyword">void</span> <span class="token function">spaff</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>第一个原型使用C语言链接性；后面两个使用C++语言链接性，第二个属于通过默认方式指出</p><p>C和C++链接性是C++标准指定的说明符，但实现可提供其他语言链接性说明符</p><h4 id="存储分配和动态分配"><a href="#存储分配和动态分配" class="headerlink" title="存储分配和动态分配"></a>存储分配和动态分配</h4><p>编译器通常使用三块独立的内存：一块用于静态变量（可能再细分），一块用于自动变量，另一块用于动态存储</p><p>C++new运算符分配的内存被称为<strong>动态内存</strong></p><p>new运算符初始化</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">*</span>pi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//*pi set to 6</span>
<span class="token keyword">double</span> <span class="token operator">*</span>pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">double</span> <span class="token punctuation">(</span><span class="token number">99.99</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// *pd set to 99.9</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>初始化常规数组和结构</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">where</span> <span class="token punctuation">{</span><span class="token keyword">double</span> x<span class="token punctuation">;</span><span class="token keyword">double</span> y<span class="token punctuation">;</span><span class="token keyword">double</span> z<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
where <span class="token operator">*</span>one <span class="token operator">=</span> <span class="token keyword">new</span> where <span class="token punctuation">{</span><span class="token number">2.5</span><span class="token punctuation">,</span><span class="token number">5.3</span><span class="token punctuation">,</span><span class="token number">7.2</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//C++11</span>
<span class="token keyword">int</span> <span class="token operator">*</span>ar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//C++11</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>new失败时，可能找不到请求的内存量，最初的10年中，C++在这种情况下让new返回空指针，但现在将引发异常std::bad_alloc</p><p><strong>new运算符、函数和替换函数</strong></p><p>运算符new和new[]分别调用如下函数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token operator">*</span><span class="token keyword">operator</span> <span class="token keyword">new</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token operator">*</span><span class="token keyword">operator</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>这些函数被称为分配函数(alloction function),它们位于全局名称空间中。同样，也有由delete和delete[]调用的释放函数(deallocation function)</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token keyword">operator</span> <span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token keyword">operator</span> <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>std::size_t是一个typedef，对应于合适的整型</p><p>对于下面的基本语句</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">*</span>pi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将被转换为下面这样</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">*</span>pi <span class="token operator">=</span> <span class="token keyword">new</span>（<span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>而下面的语句</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">*</span>pa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将被转换为下面这样</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">*</span>pa <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>使用new运算符时，可能不仅仅是调用new()函数</p><p>同样，下面的语句：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">delete</span> pi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将转换为如下函数调用</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">delete</span> <span class="token punctuation">(</span>pi<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>C++将这些函数称为**可替换的(replaceable)**。这意味着如果您有足够的知识和意愿，可为new和delete提供替换函数，并根据需要对其进行定制，例如，可定义作用域为类的替换函数，并对其进行定制，以满足该类的内存分配需求。在代码中，仍将使用new运算符，但它将调用您定义的new运算符</p><h4 id="定位运算符"><a href="#定位运算符" class="headerlink" title="定位运算符"></a>定位运算符</h4><p>一般地，new负责在堆(heap)中找到一个足以能够满足要求的内存块。new运算符还有另一种变体，被称为定位（placement）new运算符，它让您能够指定要使用的位置，程序员可能使用这种特性来设置其内存管理规程、处理需要通过特定地址进行访问的硬件或在特定位置创建对象；要使用定位new特性，首先需要包含头文件new，它提供了这种版本的new运算符的原型；然后将new运算符用于提供了所需地址的参数</p><p>示例</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;new&gt;</span></span>
<span class="token keyword">const</span> <span class="token keyword">int</span> BUF <span class="token operator">=</span> <span class="token number">512</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> buffer<span class="token punctuation">[</span>BUF<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    <span class="token keyword">double</span> <span class="token operator">*</span>pd1<span class="token punctuation">,</span> <span class="token operator">*</span>pd2<span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Calling new and placement new:\n"</span><span class="token punctuation">;</span>
    pd1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">double</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
    pd2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">(</span>buffer<span class="token punctuation">)</span> <span class="token keyword">double</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        pd2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> pd1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">+</span> <span class="token number">20.0</span> <span class="token operator">*</span> i<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Memory addresses:\n"</span>
         <span class="token operator">&lt;&lt;</span> <span class="token string">" heap: "</span> <span class="token operator">&lt;&lt;</span> pd1 <span class="token operator">&lt;&lt;</span> <span class="token string">" static: "</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span>buffer <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Memory contents:\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> pd1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" at "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>pd1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">";"</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> pd2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" at "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>pd2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\nCalling new and placement new a second time:\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> <span class="token operator">*</span>pd3<span class="token punctuation">,</span> <span class="token operator">*</span>pd4<span class="token punctuation">;</span>
    pd3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">double</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
    pd4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">(</span>buffer<span class="token punctuation">)</span> <span class="token keyword">double</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        pd4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> pd3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">+</span> <span class="token number">40.0</span> <span class="token operator">*</span> i<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Memory contents:\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> pd3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" at "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>pd3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"; "</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> pd4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" at "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>pd4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\nCalling new and placement new a third time:\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pd1<span class="token punctuation">;</span>
    pd1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">double</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
    pd2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">(</span>buffer <span class="token operator">+</span> N <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">double</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        pd2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> pd1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">+</span> <span class="token number">60.0</span> <span class="token operator">*</span> i<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Memory contents:\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> pd1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" at "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>pd1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"; "</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> pd2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" at "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>pd2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pd1<span class="token punctuation">;</span>
    <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pd2<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="C:\Users\周泽江\AppData\Roaming\Typora\typora-user-images\image-20220317194402385.png" alt="image-20220317194402385"></p><p>第二个常规new运算符查找一个新内存块，而定位new运算符分配与以前相同的内存块<br>第三次调用定位new运算符时，提供了一个从数组buffer开头算起的偏移量，因此会分配新的内存<br>程序中没有使用delete来释放使用定位new运算符分配的内存，因为buffer指定的内存是静态内存</p><p>定位new的其他形式</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span> <span class="token keyword">int</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p3 <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>定位new函数不可替换，但可重载。它至少需要接受两个参数，其中第一个总是std::size_t，指定了请求的字节数。这样的重载函数都被称为定义new，即使额外的参数没有指定位置</p><h4 id="名称空间"><a href="#名称空间" class="headerlink" title="名称空间"></a>名称空间</h4><p><strong>传统的C++名称空间</strong></p><p>C++关于全局变量和局部变量的规则定义了一种名称空间层次。每个声明区域都可以声明名称，这些名称独立于在其他声明区域中声明的名称。在一个函数中声明的局部变量不会与在另一个函数中声明的局部变量发生冲突</p><p><strong>新的名称空间特性</strong></p><p>C++新增了一种功能：一个名称空间中的名称不会与另外一个名称空间的相同名称发生冲突，同时允许程序的其他部分使用该名称空间中声明的东西。名称空间可以是全局的，也可以位于另一个名称空间中，但不能位于代码块中，因此在默认情况下，在名称空间中声明的名称的链接性为外部的（除非它引用了常量）</p><p>除了用户定义的名称空间外，还存在另一个名称空间-全局名称空间（global namespace）。它对应于文件级声明区域，因此前面所说的全局变量现在被描述为位于全局名称空间中。任何名称空间中的名称都不会与其他名称空间中的名称发生冲突</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> zhou
<span class="token punctuation">{</span>
<span class="token keyword">void</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">namespace</span> cai
<span class="token punctuation">{</span>
<span class="token keyword">double</span> fetch<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>zhou中的fetch可以与cai中的fetch共存</p><p>名称空间是开放的，可以把名称加入到已有的名称空间中</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> zhou
 <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">goose</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>同样，可在该文件后面（或另外一个文件中）再次使用zhou名称空间来提供该函数的代码</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> zhou
<span class="token punctuation">{</span>
  <span class="token keyword">void</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>访问名称空间中的名称</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">cai<span class="token double-colon punctuation">::</span>fetch <span class="token operator">=</span> <span class="token number">5.0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>using声明和using编译指令</strong></p><p>示例</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> cai
<span class="token punctuation">{</span>
<span class="token keyword">double</span> fetch<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">char</span> fetch<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">using</span> cai<span class="token double-colon punctuation">::</span>fetch<span class="token punctuation">;</span>
<span class="token keyword">double</span> fetch<span class="token punctuation">;</span>
cin <span class="token operator">&gt;&gt;</span> fetch<span class="token punctuation">;</span><span class="token comment">//读取cai::fetch</span>
cin <span class="token operator">&gt;&gt;</span> <span class="token double-colon punctuation">::</span>fetch<span class="token punctuation">;</span><span class="token comment">//读取全局变量fetch</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>还可以类似像using namespace std那样使用using namespace cai;</p><p>但是如果两个名称空间存在同名变量，需要使用作用域解析运算符，防止二义性</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">zhou<span class="token double-colon punctuation">::</span>a <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
cai<span class="token double-colon punctuation">::</span>a <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>上面两个变量是不同的标识符，表示不同的内存</p><p>但如果用using声明</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">using</span> zhou<span class="token double-colon punctuation">::</span>a<span class="token punctuation">;</span>
<span class="token keyword">using</span> cai<span class="token double-colon punctuation">::</span>a<span class="token punctuation">;</span>
a<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>编译器是不允许上述行为的，这将导致二义性</p><p>一般地使用<strong>using声明比使用using编译指令</strong>更安全，如果该名称与局部名称发生冲突，编译器将发出指示。using编译指令导入所有名称，包括可能并不需要的名称（效率）。如果与局部名称发生冲突，则局部名称将覆盖名称空间版本，而编译器并不会发出警告</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token comment">//编译指令</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用这种方法的主要原因是方便，但是名称空间的支持者会希望有更多的选择，既可以使用解析解析运算符 、，也可使用using声明，也就是说不要像上面那样做</p><p>而应这么做</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> x<span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span>cin<span class="token operator">&gt;&gt;</span>x<span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span>cout<span class="token operator">&lt;&lt;</span>x<span class="token operator">&lt;&lt;</span>std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>或者</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token keyword">int</span> x<span class="token punctuation">;</span>
cin<span class="token operator">&gt;&gt;</span>x<span class="token punctuation">;</span>
cout <span class="token operator">&lt;&lt;</span>x <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
<span class="token comment">//可以用嵌套式名称空间来创建一个包含常用using声明的名称的空间</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>名称空间的其他特性</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> elements
<span class="token punctuation">{</span>
   <span class="token keyword">namespace</span> _fire
   <span class="token punctuation">{</span>
      <span class="token keyword">int</span> flame<span class="token punctuation">;</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">float</span> water<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里flame指的是element::_fire::flame。同样，可以使用下面的using编译指令使内部的名称可用</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">using</span> <span class="token keyword">namespace</span> elements<span class="token double-colon punctuation">::</span>fire<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>也可以在名称空间中使用using编译指令和using声明，如下所示</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> myth
<span class="token punctuation">{</span>
<span class="token keyword">using</span> Jill<span class="token double-colon punctuation">::</span>fetch<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> element<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>假设要访问Jill::fetch.由于Jill::fetch现在位于名称空间myth（在这里，它被叫做fetch)中，因此可以这样访问它</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token double-colon punctuation">::</span>cin<span class="token operator">&gt;&gt;</span>myth<span class="token double-colon punctuation">::</span>fetch<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>由于它也位于Jill名称空间中，因此仍然可以称作Jill::fetch</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token double-colon punctuation">::</span>cout<span class="token operator">&lt;&lt;</span>Jill<span class="token double-colon punctuation">::</span>fetch<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果没有与之冲突的局部变量，则也可以这样做</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">using</span> <span class="token keyword">namespace</span> myth<span class="token punctuation">;</span>
cin<span class="token operator">&gt;&gt;</span> fetch<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>这说明using编译指令是可传递的。如果A op B 且 B op C，则A op C ，则说明操作op是可传递的</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">namespace</span> _cai
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> sss<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">namespace</span> zhou
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> _cai<span class="token double-colon punctuation">::</span>sss<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>

    zhou<span class="token double-colon punctuation">::</span>sss <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> zhou<span class="token punctuation">;</span>
    
    cout <span class="token operator">&lt;&lt;</span> zhou<span class="token double-colon punctuation">::</span>sss <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>还可以给空名称空间创建别名</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> my_very_favourite_things<span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">namespace</span> mvft <span class="token operator">=</span> my_very_favourite_things<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>还可以简化对嵌套名称空间的使用</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> MEF <span class="token operator">=</span> myth<span class="token double-colon punctuation">::</span>elements<span class="token double-colon punctuation">::</span>fire<span class="token punctuation">;</span>
<span class="token keyword">using</span> MEF<span class="token double-colon punctuation">::</span>flame<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>未命名的名称空间<br>可以通过省略名称空间的名称来创建未命名的名称空间</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span>
<span class="token punctuation">{</span>
   <span class="token keyword">int</span> ice<span class="token punctuation">;</span>
   <span class="token keyword">int</span> bandycoot<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>指导原则</strong></p><ul><li><p>使用在已命名的名称空间中声明的变量，而不是使用外部全局变量</p></li><li><p>使用在已命名的名称空间中声明的变量，而不是使用静态全局变量</p></li><li><p>如果开发了一个函数库或类库，将其放在一个名称空间中。事实上，C++当前提倡将标准函数库放在名称空间std中，这种做法扩展到了来自C语言中的函数。例如，头文件math.h是与C语言兼容的，没有使用名称空间，但C++头文件cmath应将各种数学库函数放在名称空间std中，实际上，并非所有的编译器都完成了这种过渡</p></li><li><p>仅将编译指令using作为一种将旧代码转换为使用名称空间的权宜之计</p></li><li><p>不要在头文件中使用using编译指令，首先，这样做掩盖了要让哪些名称可用，而且可能会引起命名等冲突</p><ul><li><p>这里可以参考</p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32925781/article/details/79454607">头文件的包含以及命名空间的引入尽量写在cpp里</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/dj0379/article/details/11565387">别再让C++头文件中出现using namespace xxx;</a></p></li></ul></li><li><p>导入名称时，首先使用作用域解析运算符或using声明的方法</p></li><li><p>对于using声明，首选将其作用域设置为局部而不是全局</p></li><li><p>使用名称空间的主旨是简化大型编程项目的管理工作，如果是对于只有一个文件的简单程序，using编译指令也不是不可以。头文件名的变化反应了这些变化，老式头文件（如iostream.h)没有使用名称空间，但新头文件iostream使用了std名称空间</p></li></ul><h3 id="对象和类"><a href="#对象和类" class="headerlink" title="对象和类"></a>对象和类</h3><h4 id="面向对象编程OOP"><a href="#面向对象编程OOP" class="headerlink" title="面向对象编程OOP"></a><strong>面向对象编程OOP</strong></h4><ul><li>面向对象编程是一种特殊的、设计程序的概念性方法</li><li>采用OOP方法时，首先从用户的角度考虑对象——描述对象所需的数据以及描述用户与数据交互所需的操作。完成对接口的描述后，需要确定如何实现接口和数据存储。最后，使用新的设计方案创建出程序</li></ul><p><strong>特性</strong></p><p>⚪抽象<br>⚪封装和数据隐藏<br>⚪多态<br>⚪继承<br>⚪代码的可重用性</p><h4 id="抽象和类"><a href="#抽象和类" class="headerlink" title="抽象和类"></a>抽象和类</h4><p><strong>类规范由两个部分组成</strong></p><p>⚪类声明：以数据成员的方式描述数据部分，以成员函数（被称为方法）的方式描述共有接口<br>⚪类方法定义:描述如何实现类成员函数</p><p><strong>访问控制</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">class</span> <span class="token class-name">Stock</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">char</span> company<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> shares<span class="token punctuation">;</span>
    <span class="token keyword">double</span> share_val<span class="token punctuation">;</span>
    <span class="token keyword">double</span> total_val<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">set_tot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> total_val <span class="token operator">=</span> shares <span class="token operator">*</span> share_val<span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">acquire</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>co<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">double</span> pr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">buy</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">double</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">sell</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">double</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">double</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>⚪关键字class标识类定义<br>⚪类名称Stock成为这个用户定义的类型的名称<br>⚪关键字public标识组成类的公共接口的类成员（抽象）<br>⚪关键字private标识只能通过公有成员访问的类成员（数据隐藏）</p><p>类设计尽可能将公有接口与实现细节分开。公有接口表示设计的抽象组件。将实现细节放在一起并将它们与抽象分开被称为封装。数据隐藏（将数据放在类的私有部分中）是一种封装，将实现的细节隐藏在私有部分中，就像stock类对set_tot()所做的那样，也是一种封装。封装的另一种例子是是，将类函数定义和类声明放在不同的文件中<br><strong>默认访问控制</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">World</span>
<span class="token punctuation">{</span>
<span class="token keyword">float</span> mass<span class="token punctuation">;</span><span class="token comment">//private by default </span>
<span class="token keyword">char</span> name<span class="token punctuation">;</span><span class="token comment">//private by default </span>
<span class="token keyword">public</span><span class="token operator">:</span>
<span class="token keyword">void</span> <span class="token function">tellall</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>由于隐藏数据是OOP主要的目标之一，因此数据项通常放在私有部分，组成类接口的成员函数放在公有部分</p><h4 id="类和结构"><a href="#类和结构" class="headerlink" title="类和结构"></a>类和结构</h4><p>C++对结构进行了扩展，使之具有与类相同的特性，唯一的区别是，结构的默认访问类型是public，而类为private。C++程序员通常使用类来实现类描述，而把结构限制为只表示纯粹的数据对象（常被称为普通老式数据（POD，Plain Old Data）结构）</p><p>实现类成员函数</p><p>成员函数定义与常规函数定义非常相似，但是它们还有两个特殊的特征</p><p>⚪定义成员函数时，使用作用域解析运算符(::)来标识函数所属的类<br>⚪类方法可以访问类的private组件</p><p>例如上述访问控制示例的update成员函数头如下</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">double</span> price<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>同时也意味着能将另一个类的成员函数也命名为update()</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token class-name">Zhou</span><span class="token double-colon punctuation">::</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>因此作用域运算符确定了方法定义对应的类的身份，标识符update()具有类作用域（class scope）<br>Stock类的其他成员函数不必使用作用域解析符，就可以使用update()方法，这是因为它们属于同一个类，因此update()是可见的，故Stock::update()是函数的限定名(qualified name);而简单的update()是全名的缩写（非限定名：unqualified name）,它只能在类作用域中使用</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"oop.h"</span></span>

<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">acquire</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string <span class="token operator">&amp;</span>co<span class="token punctuation">,</span> <span class="token keyword">long</span> n<span class="token punctuation">,</span> <span class="token keyword">double</span> pr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    company <span class="token operator">=</span> co<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Number of shares can't be negative; "</span>
                  <span class="token operator">&lt;&lt;</span> company <span class="token operator">&lt;&lt;</span> <span class="token string">" shares set to 0.\n"</span><span class="token punctuation">;</span>
        shares <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
        shares <span class="token operator">=</span> n<span class="token punctuation">;</span>
    share_val <span class="token operator">=</span> pr<span class="token punctuation">;</span>
    <span class="token function">set_tot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">buy</span><span class="token punctuation">(</span><span class="token keyword">long</span> num<span class="token punctuation">,</span> <span class="token keyword">double</span> price<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Number of shares purchased can't be negative. "</span>
                  <span class="token operator">&lt;&lt;</span> <span class="token string">"Transaction is aborted.\n"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        shares <span class="token operator">+=</span> num<span class="token punctuation">;</span>
        share_val <span class="token operator">=</span> price<span class="token punctuation">;</span>
        <span class="token function">set_tot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">sell</span><span class="token punctuation">(</span><span class="token keyword">long</span> num<span class="token punctuation">,</span> <span class="token keyword">double</span> price<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Number of shares sold can't be negative."</span>
             <span class="token operator">&lt;&lt;</span> <span class="token string">"Transaction  is aborted.\n"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&gt;</span> shares<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"You can't shell more than you have! "</span>
             <span class="token operator">&lt;&lt;</span> <span class="token string">"Transaction is aborted.\n"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        shares <span class="token operator">-=</span> num<span class="token punctuation">;</span>
        share_val <span class="token operator">=</span> price<span class="token punctuation">;</span>
        <span class="token function">set_tot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">double</span> price<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    share_val <span class="token operator">=</span> price<span class="token punctuation">;</span>
    <span class="token function">set_tot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Company: "</span> <span class="token operator">&lt;&lt;</span> company
              <span class="token operator">&lt;&lt;</span> <span class="token string">" Shares: "</span> <span class="token operator">&lt;&lt;</span> shares <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span>
              <span class="token operator">&lt;&lt;</span> <span class="token string">" Shares Price: $"</span> <span class="token operator">&lt;&lt;</span> share_val
              <span class="token operator">&lt;&lt;</span> <span class="token string">" Total Worth: $"</span> <span class="token operator">&lt;&lt;</span> total_val <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>数据私有并限于对公有函数访问的技术允许我们能够控制数据如何被使用</p><p><strong>内联方法</strong></p><p>其定义位于类声明中的函数都将自动成为内联函数，因此Stock::set_tot()是一个内联函数<br>类声明常将短小的成员函数作为内联函数，set_tot()符合这样的要求。</p><p>如果愿意，也可以在类声明之外定义成员函数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Stock</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">void</span> <span class="token function">set_tot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">set_tot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
total_val <span class="token operator">=</span> shares <span class="token operator">*</span> share_val<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>内联函数的特殊规则要求在每个使用它们的文件中都对其进行定义。确保内联定义对多文件程序中的所有文件都可用的、最简便的方法是：将内联定义放在定义类的头文件中（有些开发系统包含智能链接程序，允许将内联定义放在一个独立的实现文件）</p><p><strong>类对象</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stock kate<span class="token punctuation">,</span>joe<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>和使用结构成员一样，通过成员运算符</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">kate<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
joe<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>注意</strong>：调用成员函数时，它将使用被用来调用它的对象的数据成员</p><p>函数Kate.sell()在调用set_tot()函数时，相当于调用kate.set_tot(),这样该函数将使用kate对象的数据</p><p>所创建的每个新对象都有自己的存储空间，用于存储其内部变量和类成员：但同一个类的所有对象共享一组类方法，即每种方法只有一个副本，例如，假设kate和joe都是Stock对象，则kate.shares将占据一个内存块，而joe.shares占用另一个内存块，但kate.show()和joe.show()都调用同一个方法，也就是说它们将执行同一个代码块，只是将这些代码用于不同的数据。在OOP中，调用成员函数被称为发送消息，因此将同样的消息发送给两个不同的对象将调用同一个方法</p><p><strong>使用类</strong></p><p>可以使用new为类对象分配存储空间，可以将对象作为函数的参数和返回值，也可以将一个对象赋给另一个。</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"oop.h"</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Stock fluffy_the_cat<span class="token punctuation">;</span>
    fluffy_the_cat<span class="token punctuation">.</span><span class="token function">acquire</span><span class="token punctuation">(</span><span class="token string">"NanoSmart"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12.50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fluffy_the_cat<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fluffy_the_cat<span class="token punctuation">.</span><span class="token function">buy</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">18.125</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fluffy_the_cat<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fluffy_the_cat<span class="token punctuation">.</span><span class="token function">sell</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">20.00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fluffy_the_cat<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fluffy_the_cat<span class="token punctuation">.</span><span class="token function">buy</span><span class="token punctuation">(</span><span class="token number">300000</span><span class="token punctuation">,</span> <span class="token number">40.125</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fluffy_the_cat<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fluffy_the_cat<span class="token punctuation">.</span><span class="token function">sell</span><span class="token punctuation">(</span><span class="token number">300000</span><span class="token punctuation">,</span> <span class="token number">0.125</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fluffy_the_cat<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220318164037251.png"></p><h4 id="客户-服务器模型"><a href="#客户-服务器模型" class="headerlink" title="客户/服务器模型"></a><strong>客户/服务器模型</strong></h4><p>OOP程序员常依照客户/服务器模型来讨论程序设计。在这个概念中，客户使用类的程序。类声明（包括类方法）构成了服务器，它是程序可以使用的资源.客户只能通过以公有方式定义的接口使用服务器，这意味着客户（客户程序员）唯一的责任是了解该接口。服务器（服务器设计人员）的责任是确保服务器根据该接口可靠并准确地执行。服务器设计人员只能修改类设计的实现细节，而不能修改接口。这样程序员独立地独立地对客户和服务器进行改进，对服务器的修改不会对客户的行为造成意外的影响。</p><h4 id="类的构造函数和析构函数"><a href="#类的构造函数和析构函数" class="headerlink" title="类的构造函数和析构函数"></a><strong>类的构造函数和析构函数</strong></h4><p>C++不能像初始化结构那样初始化类</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">thing xxx <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"wodget"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//如果thing是类的话，是不允许这么做的</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>因为数据部分的访问状态是私有的，这意味着程序不能直接访问数据成员。程序只能通过成员函数来访问数据成员，因此需要设计合适的成员函数，才能成功地将对象初始化（<strong>如果使数据成员成为公有，而不是私有，使数据公有成为公有的违背了类的一个主要初衷：数据隐藏</strong>）</p><p>为此，C++提供了一个特殊的成员函数-类构造函数，专门用于构造新对象、将值付给它们的数据成员</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">class</span> <span class="token class-name">Stock</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">;</span>
	<span class="token keyword">int</span> id<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Stock</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">Stock</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Stock <span class="token function">stock</span><span class="token punctuation">(</span><span class="token string">"zhoumouren"</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	stock<span class="token punctuation">.</span><span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	stock<span class="token punctuation">.</span><span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220318164822735.png"></p><p><strong>显式调用构造函数</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stock stock_1 <span class="token operator">=</span> <span class="token function">Stock</span><span class="token punctuation">(</span><span class="token string">"zhoumouren"</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>隐式调用构造函数</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stock stock_2<span class="token punctuation">{</span><span class="token string">"caimouren"</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>每次创建类对象（甚至使用new动态分配内存）时，C++都使用类构造函数。下面是将构造函数与new一起使用的方法</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stock <span class="token operator">*</span>pstock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Stock</span><span class="token punctuation">(</span><span class="token string">"zhoumouren"</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//这种情况下对象没有名称，但可以使用指针来管理该对象</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><code>**但无法使用对象来调用构造函数，因为在构造函数构造出对象之前，对象是不存在的**</code></p><p><strong>默认构造函数</strong><br>默认构造函数是在未提供显式初始值时，用来创建对象的构造函数。<br>对于Stock类来说，默认构造函数可能如下</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>但是如果提供了非默认构造函数，但没有提供默认构造函数，那么下面的声明将出错</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">class</span> <span class="token class-name">Stock</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">;</span>
	<span class="token keyword">int</span> id<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Stock</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">Stock</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"function start"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
	name <span class="token operator">=</span> <span class="token string">"caimouren"</span><span class="token punctuation">;</span>
	id <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Stock zhou <span class="token operator">=</span> <span class="token function">Stock</span><span class="token punctuation">(</span><span class="token string">"zhoumouren"</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用非默认构造函数</span>
	Stock cai<span class="token punctuation">;</span><span class="token comment">//调用构造函数</span>
	zhou<span class="token punctuation">.</span><span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	zhou<span class="token punctuation">.</span><span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cai<span class="token punctuation">.</span><span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cai<span class="token punctuation">.</span><span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>析构函数</strong></p><p>用构造函数创建对象后，程序负责跟踪该对象，直到其过期为止。对象过期时，程序将自动调用一个特殊的成员函数——析构函数。析构函数会完成清理工作，例如构造函数使用new来分配内存，则析构函数将使用delete来释放这些内存。Stock的构造函数没有使用new，因此析构函数实际上没有需要完成的任务，这种情况下，只需让编译器生成一个什么都不做的隐式析构函数即可。</p><p>在类名前加上~,Stock类的析构函数为</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token operator">~</span><span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果创建的是静态存储类对象，则其析构函数将在程序结束时调用。如果创建的自动存储类对象，则其析构函数将在程序执行完代码块时自动被调用。如果对象是通过new创建的，则它将驻留在栈内存或自由存储区中，当使用delete来释放内存时，其析构函数将自动被调用。最后，程序可以创建临时对象来完成特定的操作，在这种情况下，程序将在结束对该对象的使用时自动调用其析构函数</p><p>由于在类对象过期时析构函数将自动被调用，因此必须有一个析构函数。如果程序员没有提供析构函数，编译器将隐式地声明一个默认析构函数，并在发现导致对象被删除的代码后，提供默认析构函数的定义</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">class</span> <span class="token class-name">Stock</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">;</span>
	<span class="token keyword">int</span> id<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Stock</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">~</span><span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">Stock</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"function start"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
	name <span class="token operator">=</span> <span class="token string">"caimouren"</span><span class="token punctuation">;</span>
	id <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"function end"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token punctuation">{</span>
		Stock zhou <span class="token operator">=</span> <span class="token function">Stock</span><span class="token punctuation">(</span><span class="token string">"zhoumouren"</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Stock cai <span class="token operator">=</span> <span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		zhou<span class="token punctuation">.</span><span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		zhou<span class="token punctuation">.</span><span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cai<span class="token punctuation">.</span><span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cai<span class="token punctuation">.</span><span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220318174112989.png"></p><p>main中代码块为整个main()，因此仅当main()执行完毕后，才会调用析构函数，在窗口环境上，这意味着将在两个析构函数调用前关闭，导致您无法看到最后两条消息。但添加这些大括号后，析构函数将在到达返回语句前执行。</p><p>这里需要注意的是临时对象</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">class</span> <span class="token class-name">Stock</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">;</span>
	<span class="token keyword">int</span> id<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Stock</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">~</span><span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	id <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">Stock</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"function start"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
	name <span class="token operator">=</span> <span class="token string">"caimouren"</span><span class="token punctuation">;</span>
	id <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"function end$"</span> <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token punctuation">{</span>
		Stock zhou <span class="token operator">=</span> <span class="token function">Stock</span><span class="token punctuation">(</span><span class="token string">"zhoumouren"</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Stock ha<span class="token punctuation">;</span>
		Stock cai<span class="token punctuation">;</span>
		cai<span class="token punctuation">.</span><span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cai <span class="token operator">=</span> <span class="token function">Stock</span><span class="token punctuation">(</span><span class="token string">"bbb"</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cai<span class="token punctuation">.</span><span class="token function">show_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		ha <span class="token operator">=</span> <span class="token function">Stock</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220318174625797.png"></p><p>上述两条语句是调用构造函数来创建一个临时对象，然后将该临时对象复制到cai或者ha，并丢弃它，从上述示例代码结果可以看出，如果采用这种方式，则在下一条语句前会直接调用析构函数，然后在对象过期时还会再调用一遍析构函数，但把另一个对象地成员复制给另一个</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">ha <span class="token operator">=</span> cai<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>他不会说直接丢弃它，cai会覆盖ha的原本内容，ha的析构函数执行顺序还是依照对象创建先后时期来判断（先创建的对象先调用构造函数，析构函数是最后才调用，以此类推）</p><p>所以<strong>执行顺序</strong></p><p><strong>①临时对象复制数据的析构函数</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">cai <span class="token operator">=</span> <span class="token function">Stock</span><span class="token punctuation">(</span><span class="token string">"bbb"</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>②后创建的对象的析构函数</strong>（因为自动变量被放在栈中，所以最后创建的对象最先被删除）</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220318180021714.png"></p><p>如果既可以通过初始化，也可以通过赋值来设置对象的值，则应采用初始化方式。通常这种方式的效率更高。</p><p>C++11列表初始化</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stock zhou <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"zhoumouren"</span><span class="token punctuation">,</span><span class="token number">127</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
Stock haha<span class="token punctuation">{</span> <span class="token string">"guang"</span><span class="token punctuation">,</span><span class="token number">999</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
Stock zhang <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>C++11 还提供了名为std::initialize_list的类，可将其用作函数参数或方法参数的类型。这个类可表示任意长度的列表，只要所有列表项的类型都相同或可转换为相同的类型。</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> Stock cai <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"hahaa"</span><span class="token punctuation">,</span><span class="token number">111</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
cai<span class="token punctuation">.</span><span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>编译器将拒绝第二行，因为show()的代码无法确保调用对象不被修改</p><p>故此需要一种新的语法——保证函数不会修改调用对象</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">void</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">show_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="this指针"><a href="#this指针" class="headerlink" title="this指针"></a>this指针</h4><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220319164010885.png"></p><p>那么问题来了，如果是调用stock1.topval(stock2)，s是stock2的别名，但stock1没有别名</p><p>C++解决这个问题的方法是引入this这个特殊的指针。this指针指向用来调用成员函数的对象(this被作为隐藏参数传递给方法)。这里this将设置为stock1对象的地址，这里total_val只不过是this-&gt;total_val的简写罢了</p><p>⚪this：对象的地址<br>⚪*this：对象本身</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> Stock <span class="token operator">&amp;</span> <span class="token class-name">Stock</span><span class="token double-colon punctuation">::</span><span class="token function">topval</span><span class="token punctuation">(</span><span class="token keyword">const</span> Stock <span class="token operator">&amp;</span>s<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>total_val <span class="token operator">&gt;</span> total_val<span class="token punctuation">)</span>
       <span class="token keyword">return</span> s<span class="token punctuation">;</span>
   <span class="token keyword">else</span> 
       <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="对象数组"><a href="#对象数组" class="headerlink" title="对象数组"></a><strong>对象数组</strong></h4><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">Stock zhou[3];
Stock haha[3]={
Stock("zhoumouren",1),
Stock("caimouren",2),
Stock("huangmouren",3)
};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>该数组每个元素都是对象，都会调用默认构造函数（如果没有初始化）以及相应的析构函数</p><h4 id="类作用域"><a href="#类作用域" class="headerlink" title="类作用域"></a><strong>类作用域</strong></h4><p>⚪在类中定义的名称（如类数据成员名和类成员函数名）的作用域为整个类<br>⚪在定义成员函数时，必须使用作用域运算符：</p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">void Stock::update(double price)
{
...
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>⚪使用类成员名时，必须根据上下文使用直接成员运算符(.)、间接成员运算符(-&gt;)或作用域解析运算符(::)</p><p><strong>作用域为类的常量</strong></p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">class Bakery
{
private:
   const int Months = 12;//fails
   double cost[Months];
 }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>其实上述代码是行不通的，因为在创建对象前，没有用于存储值的空间，然而有两种方式可以实现这个目标，并且效果相同</p><p><strong>第一种方法</strong></p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">class Bakery
{
private:
   enum{Months = 12};
   double cost[Months];
   ...
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>用这种方式声明枚举并不会创建类数据成员。也就是说，所有对象都不包含枚举，另外Months只是一个符号名称，在作用域为整个类的代码中遇到它时，编译器将用12来替换它，这里使用枚举只是为了创建常量，并不打算创建枚举类型的变量，因此不需要提供枚举名</p><p><strong>第二种方法</strong></p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">class Bakery
{
private:
   static const int Months =  12;
   double cost[Months];
...
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这将创建一个名为Months的常量，该常量将与其他静态变量存储在一起，而不是存储在对象中，因此，只有一个Months常量，被所有Bakery对象共享。在C++98中，只能使用这种技术声明值为整数或枚举的静态常量，而不能存储double常量。C++11消除了这种限制</p><p><strong>作用域内枚举（C++11</strong>）</p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">enum egg{Small,Medium};
enum t_shirt{Small,Medium};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>这无法通过编译，因为egg Small和t_shirt Small位于相同的作用域内，它们将发生冲突，为避免这种问题，C++11提供了一种新枚举，其枚举量的作用域为类。这种枚举的声明如下</p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">enum class egg{Small,Medium};
enum class t_shirt{Small,Medium};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>也可以使用关键字struct代替class<br>枚举量的作用域为类后，不同枚举定义中的枚举量就不会发生名称冲突了，而您可继续编写处理鸡蛋和T恤的项目</p><p>C++11还提高了作用域内枚举的类型安全。有些情况下，常规枚举将自动转换为整型，如果将其赋给int变量或用于表达式，但作用域内枚举不能隐式地转换为整型</p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">enum egg{Small,Medium};
enum class t_shirt{aSmall,aMedium};
egg one = Medium;
int king = one;
if(king &lt; Medium)//allowed
{...}
if(king &lt; t_shirt::aMedium)//not allowed
{...}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>必要时，可进行显示类型转换<br>int Frodo = int(t_shirt::aSmall);<br>枚举用某种底层整型类型表示，在C++98中，如何选择取决于实现，因此包含枚举的结构的长度可能随系统而异。对于作用域内枚举，C++11消除了这种依赖性。默认情况下，C++11作用域内枚举的底层类型为int，另外还可以这样</p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">enum class:short pizza{Small,Medium};
//:short将底层类型指定为short.底层类型必须为整型.
//但如果没有指定，编译器选择的底层类型将随实现而异<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="抽象数据类型"><a href="#抽象数据类型" class="headerlink" title="抽象数据类型"></a><strong>抽象数据类型</strong></h4><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/2020110510303938.png"></p><p>其中C++程序通过栈来管理自动变量</p><p>⚪可创建空栈<br>⚪可将数据项添加到栈内（压入）<br>⚪可从栈顶删除数据项（弹出）<br>⚪可查看栈是否填满<br>⚪可查看栈是否为空</p><p>可以将上述描述转化为一个类声明，其中公有成员函数提供了表示栈操作的接口，而私有数据成员负责存储栈数据。类概念非常适合于ADT方法</p><h3 id="类的使用"><a href="#类的使用" class="headerlink" title="类的使用"></a>类的使用</h3><h4 id="运算符重载"><a href="#运算符重载" class="headerlink" title="运算符重载"></a>运算符重载</h4><p>⚪运算符重载是C++多态的一种形式，例如*运算符可用于地址，将得到存储在这个地址中的值，但将它用于两个数字时，便是它们的乘积。<br>⚪C++允许将运算符重载扩展到用户定义的类型，例如允许使用+将两个对象相加。编译器根据操作数的数目和类型决定使用哪种加法定义。重载运算符可使代码看起来更自然</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">20</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
      evening<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sam<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> janet<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// add element by element</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>但在C++中，可以定义一个表示数组的类，并重载+运算符</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">evening <span class="token operator">=</span> sam <span class="token operator">+</span> janet<span class="token punctuation">;</span><span class="token comment">//add two array object</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这种简单的加法表示法隐藏了内部机理</p><p>例如,operator+()重载+运算符</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">district <span class="token operator">=</span> sid <span class="token operator">+</span> sara<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>编译器发现，操作数是类对象，因此使用相应的运算符函数替换上述运算符</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">district <span class="token operator">=</span> sid<span class="token punctuation">.</span><span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>sara<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后该函数将隐式地使用sid（因为它调用了方法），而显式地使用sara对象（因为它被作为参数传递）</p><p><strong>运算符重载示例</strong></p><p>mytime.h</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">MYTIME_H_</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MYTIME_H_</span></span>
<span class="token keyword">class</span> <span class="token class-name">Time</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> hours<span class="token punctuation">;</span>
	<span class="token keyword">int</span> minutes<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Time</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">,</span> <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">AddMin</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">AddHr</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">Reset</span><span class="token punctuation">(</span><span class="token keyword">int</span> h <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Time <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Time <span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">;</span>
    
	<span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>mytime.cpp</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"mytime.h"</span></span>

<span class="token class-name">Time</span><span class="token double-colon punctuation">::</span><span class="token function">Time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	hours <span class="token operator">=</span> minutes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Time</span><span class="token double-colon punctuation">::</span><span class="token function">Time</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	hours <span class="token operator">=</span> h<span class="token punctuation">;</span>
	minutes <span class="token operator">=</span> m<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Time</span><span class="token double-colon punctuation">::</span><span class="token function">AddMin</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	minutes <span class="token operator">+=</span> m<span class="token punctuation">;</span>
	hours <span class="token operator">+=</span> minutes <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">;</span>
	minutes <span class="token operator">%=</span> <span class="token number">60</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Time</span><span class="token double-colon punctuation">::</span><span class="token function">AddHr</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	hours <span class="token operator">+=</span> h<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Time</span><span class="token double-colon punctuation">::</span><span class="token function">Reset</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	hours <span class="token operator">=</span> h<span class="token punctuation">;</span>
	minutes <span class="token operator">=</span> m<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Time Time<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Time <span class="token operator">&amp;</span>t<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
	Time sum<span class="token punctuation">;</span>
	sum<span class="token punctuation">.</span>minutes <span class="token operator">=</span> minutes <span class="token operator">+</span> t<span class="token punctuation">.</span>minutes<span class="token punctuation">;</span>
	sum<span class="token punctuation">.</span>hours <span class="token operator">=</span> hours <span class="token operator">+</span> t<span class="token punctuation">.</span>hours <span class="token operator">+</span> sum<span class="token punctuation">.</span>minutes <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">;</span>
	sum<span class="token punctuation">.</span>minutes <span class="token operator">%=</span> <span class="token number">60</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Time</span><span class="token double-colon punctuation">::</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> hours <span class="token operator">&lt;&lt;</span> <span class="token string">" hour,"</span> <span class="token operator">&lt;&lt;</span> minutes <span class="token operator">&lt;&lt;</span> <span class="token string">" minutes"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>TIme.cpp</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"mytime.h"</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span>
	<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
	Time planning<span class="token punctuation">;</span>
	Time <span class="token function">coding</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Time <span class="token function">fixing</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Time total<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"planning time = "</span><span class="token punctuation">;</span>
	planning<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"coding time = "</span><span class="token punctuation">;</span>
	coding<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"fixing time = "</span><span class="token punctuation">;</span>
	fixing<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    
    total <span class="token operator">=</span> coding <span class="token operator">+</span> fixing<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"coding+fixing="</span><span class="token punctuation">;</span>
    total<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>这里需要注意的是</strong>：重载不要返回指向局部变量或者临时对象的引用。函数执行完毕后，局部变量和临时对象将消失，引用将指向不存在的数据</p><p>同理可以将声明中的Sum()换为operator+(),可以重载加法运算符，此时</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">total <span class="token operator">=</span> coding <span class="token operator">+</span> fixing<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>等价于</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">total <span class="token operator">=</span> coding<span class="token punctuation">.</span><span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>fixing<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>有人会问可以total = coding + fixing + complicate;<strong>是否可行</strong></p><p>当然可以，函数参数本身被转换一个函数调用（+是从左向右结合的运算符）</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">total <span class="token operator">=</span> coding<span class="token punctuation">.</span><span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>fixing<span class="token punctuation">.</span><span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>complicate<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>重载限制</strong></p><p><strong>1.不能重载的运算符</strong></p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220319201556648.png"></p><p><strong>2.不能创建新运算符，例如不能定义operator()函数来表示求幂</strong>**</p><p><strong>3.使用运算符时不能违反运算符原来的句法规则。例如，不能将求模运算符%重载用成一个操作数</strong></p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220319202718507.png"></p><p><strong>4.不能修改运算符的优先级，重载后的运算符和原来的运算符优先级相同</strong></p><p><strong>5.重载后的运算符必须至少有一个操作数是用户定义的类型，这样可以防止用户重载标准类型，因此不能将减法运算符-重载为两个int的和.虽然这种限制将对创造性有所影响，但可以确保程序正常运行</strong></p><p><strong>6.表11.1的大多数运算符都可以通过成员或非成员函数进行重载，但下面的运算符只通过成员函数进行重载</strong></p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220321001323216.png"></p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220321000945286.png"></p><p>除了这些正式限制之外，还应在重载运算符时遵循一些明智的限制。例如，不要将*运算符重载成交换两个Time对象的数据成员。表示法中没有任何内容可以表明运算符完成的工作，因此最好定义一个其名称具有说明性的类方法，如Swap()</p><p>其他重载运算符示例</p><p>mytime.cpp</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Time Time<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Time <span class="token operator">&amp;</span>t<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
	Time sum<span class="token punctuation">;</span>
	sum<span class="token punctuation">.</span>minutes <span class="token operator">=</span> minutes <span class="token operator">+</span> t<span class="token punctuation">.</span>minutes<span class="token punctuation">;</span>
	sum<span class="token punctuation">.</span>hours <span class="token operator">=</span> hours <span class="token operator">+</span> t<span class="token punctuation">.</span>hours <span class="token operator">+</span> sum<span class="token punctuation">.</span>minutes <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">;</span>
	sum<span class="token punctuation">.</span>minutes <span class="token operator">%=</span> <span class="token number">60</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Time Time<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">const</span> Time <span class="token operator">&amp;</span>t<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
	Time diff<span class="token punctuation">;</span>
	<span class="token keyword">int</span> tot1<span class="token punctuation">,</span> tot2<span class="token punctuation">;</span>
	tot1 <span class="token operator">=</span> t<span class="token punctuation">.</span>minutes <span class="token operator">+</span> <span class="token number">60</span> <span class="token operator">*</span> t<span class="token punctuation">.</span>hours<span class="token punctuation">;</span>
	tot2 <span class="token operator">=</span> minutes <span class="token operator">+</span> <span class="token number">60</span> <span class="token operator">*</span> hours<span class="token punctuation">;</span>
	diff<span class="token punctuation">.</span>minutes <span class="token operator">=</span> <span class="token punctuation">(</span>tot2 <span class="token operator">-</span> tot1<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">;</span>
	diff<span class="token punctuation">.</span>hours <span class="token operator">=</span> <span class="token punctuation">(</span>tot2 <span class="token operator">-</span> tot1<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> diff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Time Time<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">double</span> mult<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
	Time result<span class="token punctuation">;</span>
	<span class="token keyword">long</span> totalminutes <span class="token operator">=</span> hours <span class="token operator">*</span> mult <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> minutes <span class="token operator">*</span> mult<span class="token punctuation">;</span>
	result<span class="token punctuation">.</span>hours <span class="token operator">=</span> totalminutes <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">;</span>
	result<span class="token punctuation">.</span>minutes <span class="token operator">=</span> totalminutes <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">total <span class="token operator">=</span> coding <span class="token operator">+</span> fixing <span class="token operator">+</span> complicate<span class="token punctuation">;</span>
total <span class="token operator">=</span> total <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">;</span>
total <span class="token operator">=</span> total <span class="token operator">-</span> coding<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="友元"><a href="#友元" class="headerlink" title="友元"></a>友元</h4><p>C++控制对类对象私有部分的访问，通常，公有类方法提供唯一访问途径，但是有时候这种限制太严格，以至于不适合特定的编程问题。在这种情况下，C++提供了另外一种形式的访问权限：友元。友元有3种</p><p>⚪友元函数<br>⚪友元类<br>⚪友元成员函数</p><p>通过让函数成为类的友元，可以赋予函数与类的成员函数相同的访问权限，为类重载二元运算符时，常常需要友元</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">A <span class="token operator">=</span> B<span class="token operator">*</span><span class="token number">5.0</span><span class="token punctuation">;</span><span class="token comment">//将被转换为A = B.operator*(5.0);</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将被转换为下面的成员函数调用</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">A <span class="token operator">=</span> <span class="token number">5.0</span><span class="token operator">*</span>B<span class="token punctuation">;</span><span class="token comment">//cannot</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>但是可以使用友元函数非成员函数来使得这个表达式成立</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220321143824849.png"></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">A <span class="token operator">=</span> <span class="token number">5.0</span><span class="token operator">*</span>B<span class="token punctuation">;</span><span class="token comment">//yeah</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>类的友元函数就是非成员函数，其访问权限与成员函数相同</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Time <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">double</span> m<span class="token punctuation">,</span><span class="token keyword">const</span> Time <span class="token operator">&amp;</span>t<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">return</span> t<span class="token operator">*</span>m<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220321144412427.png"></p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220321144429812.png"></p><p><strong>常用的友元</strong></p><p><strong>重载&lt;&lt;运算符的第一种版本</strong></p><p>类中使用的show()若能像下面的操作会更好</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">cout <span class="token operator">&lt;&lt;</span> trip<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果使用一个Time成员函数来重载&lt;&lt;，Time对象将是第一个操作数，就像使用成员函数重载*运算符那样。这意味着必须像下面一样</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">trip <span class="token operator">&lt;&lt;</span> cout<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>但通过友元函数可以像下面这样</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span><span class="token keyword">const</span> Time <span class="token operator">&amp;</span>t<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
os<span class="token operator">&lt;&lt;</span> t<span class="token punctuation">.</span>hours<span class="token operator">&lt;&lt;</span><span class="token string">" hours,"</span> <span class="token operator">&lt;&lt;</span>t<span class="token punctuation">.</span>minutes <span class="token operator">&lt;&lt;</span><span class="token string">" minutes"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>重载&lt;&lt;运算符的第二种版本</strong></p><p>但这种实现不允许像通常那样将重新定义的&lt;&lt;运算符与cout一起使用</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Trip time"</span> <span class="token operator">&lt;&lt;</span> trip <span class="token operator">&lt;&lt;</span> <span class="token string">"周二"</span> <span class="token punctuation">;</span><span class="token comment">//cannot</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>举个例子</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
cout <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> y<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>它相当于</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>cout <span class="token operator">&lt;&lt;</span> x<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> y<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>表达式(cout&lt;&lt;x)本身就是ostream对象，这样的话要修改第一种版本，让他返回ostream对象的引用</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">ostream <span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span><span class="token keyword">const</span> Time <span class="token operator">&amp;</span>t<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	os<span class="token operator">&lt;&lt;</span>t<span class="token punctuation">.</span>hours<span class="token operator">&lt;&lt;</span><span class="token string">" hours"</span> <span class="token operator">&lt;&lt;</span>t<span class="token punctuation">.</span>minutes <span class="token operator">&lt;&lt;</span> <span class="token string">" minutes"</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> os<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这样一来<code>cout &lt;&lt; trip;</code>就等价于<code>operator&lt;&lt;(cout,trip);</code></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Trip time"</span> <span class="token operator">&lt;&lt;</span> trip <span class="token operator">&lt;&lt;</span> <span class="token string">"周二"</span> <span class="token punctuation">;</span><span class="token comment">//can do</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>我们分成多步</p><p>1.<code>cout&lt;&lt;"Trip time: "</code>将显示字符串然后返回值被cout所替代，被简化成<code>cout&lt;&lt;trip&lt;&lt;"周二";</code></p><p>2.程序使用&lt;&lt;的Time声明显示trip值，并再次返回cout对象，这将语句简化为<code>cout&lt;&lt;Tuesday;</code></p><p>3.程序使用ostream中用于字符串的&lt;&lt;定义，来显示最后一个字符串，并结束运行</p><h4 id="成员函数和非成员函数"><a href="#成员函数和非成员函数" class="headerlink" title="成员函数和非成员函数"></a>成员函数和非成员函数</h4><p>一般来说，重载运算符中的非成员函数应是友元函数，这样它才能访问类的私有数据</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Time <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Time <span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">;</span><span class="token comment">//number verson</span>
<span class="token keyword">friend</span> Time <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Time <span class="token operator">&amp;</span>t1<span class="token punctuation">,</span><span class="token keyword">const</span> Time <span class="token operator">&amp;</span>t2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//nonmember version</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220321160117520.png"></p><p>在定义运算符时选择其中一种格式就好，避免二义性错误的出现</p><h4 id="类的自动转换和强制类型转换"><a href="#类的自动转换和强制类型转换" class="headerlink" title="类的自动转换和强制类型转换"></a>类的自动转换和强制类型转换</h4><p>下面的语句都将导致数值类型转换</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">long</span> count <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span><span class="token comment">//int value 8 converted to type long </span>
<span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span><span class="token comment">//int value 11 converted to type double </span>
<span class="token keyword">int</span> side <span class="token operator">=</span> <span class="token number">3.33</span><span class="token punctuation">;</span><span class="token comment">//double value 3.33 converted to type int 3 </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>C++语言不自动地转换不兼容的类型</p><p>下面的语句就是非法的，因为左边是指针类型，而右边是数字</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//type clash </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在无法自动转换时，可以使用强制类型转换</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//ok,p and (int*) 10 both pointer</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>构造函数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">Stonewt</span><span class="token punctuation">(</span><span class="token keyword">double</span> lbs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//template for double-to-stonewt conversion</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>可以编写这样的代码</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt myCat<span class="token punctuation">;</span><span class="token comment">//create a Stonewt object</span>
myCat <span class="token operator">=</span> <span class="token number">19.6</span><span class="token punctuation">;</span><span class="token comment">//use Stonewt(double) to convert 19.6 to Stonewt</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>采用成员赋值方式将该临时对象的内容复制到myCat中，这一过程是隐式转换，是自动进行的</p><p>再来看下面这个代码</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">Stonewt</span><span class="token punctuation">(</span><span class="token keyword">int</span> stn<span class="token punctuation">,</span><span class="token keyword">double</span> lbs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// not a conversion function</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>但是如果给第二个参数提供默认值，他便可用于转换int</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">Stonewt</span><span class="token punctuation">(</span><span class="token keyword">int</span> stn<span class="token punctuation">,</span><span class="token keyword">double</span> lbs <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//int-to-Stonewt conversion</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将构造函数用作自动类型转换函数似乎是一项不错的特性。但其实这是会导致意外的类型转换的。因此C++新增了关键字explicit，用于关闭这种自动特性。也就是说，可以这样声明构造函数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">explicit</span> <span class="token function">Stonewt</span><span class="token punctuation">(</span><span class="token keyword">double</span> lbs<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这将关闭隐式转换，但仍然允许显式转换，即显式强制类型转换</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt myCat<span class="token punctuation">;</span>
myCat <span class="token operator">=</span> <span class="token number">19.6</span><span class="token punctuation">;</span><span class="token comment">//not valid</span>
mycat <span class="token operator">=</span> <span class="token function">Stonewt</span><span class="token punctuation">(</span><span class="token number">19.6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ok</span>
mycat <span class="token operator">=</span>（Stonewt）<span class="token number">19.6</span><span class="token punctuation">;</span><span class="token comment">//ok</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>只接受一个参数的构造函数定义了从参数类型到类类型的转换。如果使用关键字explicit限定了这种构造函数，则它只能用于显式转换，否则也可以用于隐式转换</p><p>编译器在什么时候将使用Stonewt(double)函数呢？如果在声明中使用了关键字explicit,则Stonewt(double)将只用于显式强制类型转换，否则还可以用于下面的隐式转换</p><p>⚪将Stonewt对象初始化为double时</p><p>⚪将double值赋给Stonewt对象时</p><p>⚪将double值传递给接受Stonewt参数的函数时</p><p>⚪返回值被声明为Stonewt的函数试图返回double值时</p><p>函数原型化提供的参数匹配过程，允许使Stonewt(double)构造函数来转换其他数值类型，下面两条语句都首先将int转换为double，然后使用Stonewt(double)构造函数。</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt <span class="token function">Jumbo</span><span class="token punctuation">(</span><span class="token number">7000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//uses Stonewt(double),converting int to double</span>
Jumbo <span class="token operator">=</span> <span class="token number">7300</span><span class="token punctuation">;</span><span class="token comment">//uses Stonewt(double),converting int to double</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>仅当不存在二义性时，才会进行二步转换，如果这个类还定义了构造函数Stonewt(long),则编译器将拒绝这些语句，可能指出：int可被转换为long或double，因此调用存在二义性</strong></p><p>当构造函数只接受一个参数时，可以使用下面的格式来初始化类对象</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt incognito <span class="token operator">=</span> <span class="token number">275</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这等价于前面介绍过的另外两种格式</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt <span class="token function">incognito</span><span class="token punctuation">(</span><span class="token number">275</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Stonewt incognito <span class="token operator">=</span> <span class="token function">Stonewt</span><span class="token punctuation">(</span><span class="token number">275</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>转换函数</strong></p><p>示例</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt <span class="token function">wolfe</span><span class="token punctuation">(</span><span class="token number">285.7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> host <span class="token operator">=</span> wolfe<span class="token punctuation">;</span>	<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>转换函数使用户定义的强制类型转换</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt <span class="token function">wolfe</span><span class="token punctuation">(</span><span class="token number">285.7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> host <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">(</span>wolfe<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> thinker <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> wolfe<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>也可以让编译器做决定</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt <span class="token function">wells</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> star <span class="token operator">=</span> wells<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>要转换为typeName类型，需要使用这种形式的转换函数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">operator</span> <span class="token function">typeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>请注意以下几点</p><p>⚪转换函数必须是类方法<br>⚪转换函数不能指定返回类型<br>⚪转换函数不能有参数</p><p>例如，转换为double类型为</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">operator</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>下面看stonewt的代码<br>头文件stonewt.h修改<br>添加以下两条语句</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">operator</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token comment">//四舍五入，不是保留整数部分</span>
<span class="token keyword">operator</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>stonewt.cpp修改<br>添加两个定义</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">int</span><span class="token punctuation">(</span>pounds <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Stonewt<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> pounds<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>但程序像<code>double p_wt = poppins;</code>这样隐式转换是好的吗？其实最好是显式的例如：<br>我写<code>long gone = poppins;</code>则会存在二义性错误<br>最好可以这样的写法：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">long</span> gone <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> poppins<span class="token punctuation">;</span>
<span class="token keyword">long</span> gone <span class="token operator">=</span> <span class="token keyword">int</span> <span class="token punctuation">(</span>poppins<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>所以C++11消除了C++98不能用于转换函数的关键字explicit，C++11的关键字explicit可以用于转换函数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Stonewt</span>
<span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">explicit</span> <span class="token keyword">operator</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token keyword">explicit</span> <span class="token keyword">operator</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>另一种方法，用一个功能相同的非转换函数替换该转换函数即可，但仅在被显式地调用时，该函数才会执行</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token keyword">int</span><span class="token punctuation">(</span>pound<span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>替换为</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token class-name">Stonewt</span><span class="token double-colon punctuation">::</span><span class="token function">Stone_to_Int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token keyword">int</span> <span class="token punctuation">(</span>pound<span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这样，下面的语句将是非法的</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> plb <span class="token operator">=</span> poppins<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>但如果确实需要这种转换，可以这样做</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> plb <span class="token operator">=</span> poppins<span class="token punctuation">.</span><span class="token function">Stone_to_Int</span><span class="token punctuation">(</span><span class="token punctuation">)</span>；<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>转换函数和友元函数</strong></p><p>成员函数实现加法</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt Stonewt<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Stonewt <span class="token operator">&amp;</span>st<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
 <span class="token keyword">double</span> pds <span class="token operator">=</span> pounds <span class="token operator">+</span> st<span class="token punctuation">.</span>pounds<span class="token punctuation">;</span>
 Stonewt <span class="token function">sum</span><span class="token punctuation">(</span>pds<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>友元函数实现加法</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Stonewt <span class="token operator">&amp;</span>st1<span class="token punctuation">,</span><span class="token keyword">const</span> Stonewt <span class="token operator">&amp;</span>st2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">double</span> pds <span class="token operator">=</span> st1<span class="token punctuation">.</span>pounds<span class="token operator">+</span>st2<span class="token punctuation">.</span>pounds<span class="token punctuation">;</span>
    Stonewt <span class="token function">sum</span><span class="token punctuation">(</span>pds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面两种格式都允许</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Stonewt <span class="token function">b</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Stonewt c<span class="token punctuation">;</span>
c <span class="token operator">=</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span><span class="token comment">//可能转换为c=a.operator+(b);或c=operator+(a,b);</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>如果提供了Stonewt(double)的函数，也可以</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token number">176.0</span><span class="token punctuation">;</span>
Stonewt c<span class="token punctuation">;</span>
c <span class="token operator">=</span> a<span class="token operator">+</span>d<span class="token punctuation">;</span><span class="token comment">//被转换为c=a.operator+(d);</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>但只有友元才允许这么做,如果提供了Stonewt(double)的函数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> e <span class="token operator">=</span> <span class="token number">146.0</span><span class="token punctuation">;</span>
Stonewt c<span class="token punctuation">;</span>
c <span class="token operator">=</span> e <span class="token operator">+</span> a<span class="token punctuation">;</span><span class="token comment">//被转换为c = operator(e,a);</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>但是在这种情况下，如果定义了operator double()将导致二义性</strong></p><p>不能调用成员函数将a和e相加</p><p>类似</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">c <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//没意义，c++不会试图将e转换为Stonewt对象</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>其实也可以将加法运算符重载为一个显示使用double类型参数的函数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Stonewt <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//member function</span>
<span class="token keyword">friend</span> Stonewt <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span>Stonewt <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>前面重载的方法</strong>使程序更简短，因为定义的函数较少，这意味着程序员出错机会少，要完成的工作少，但是缺点也很明显，每次转换都会调用构造函数，增加和内存开销，<strong>上述的方法</strong>，程序更长，程序员要完成的工作多，但运行速度较快</p><h3 id="类和动态内存分配"><a href="#类和动态内存分配" class="headerlink" title="类和动态内存分配"></a>类和动态内存分配</h3><h4 id="动态内存和类"><a href="#动态内存和类" class="headerlink" title="动态内存和类"></a>动态内存和类</h4><p><strong>C++使用new和delete运算符来动态控制内存</strong></p><p>stringbad.h</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">STRINGBAD_H_</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STRINGBAD_H_</span></span>
<span class="token keyword">class</span> <span class="token class-name">StringBad</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">;</span>
	<span class="token keyword">int</span> len<span class="token punctuation">;</span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> num_strings<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">StringBad</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//constructor</span>
	<span class="token function">StringBad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">~</span><span class="token function">StringBad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">friend</span> std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> StringBad<span class="token operator">&amp;</span> at<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220321200034274.png"></p><p>静态类成员有一个特点：无论创建了多少对象，程序只创建一个静态类变量副本，类的所有对象共享同一个静态成员</p><p>stringbad.cpp</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstring&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"stringbad.h"</span></span>
<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span>
<span class="token keyword">int</span> StringBad<span class="token double-colon punctuation">::</span>num_strings <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token class-name">StringBad</span><span class="token double-colon punctuation">::</span><span class="token function">StringBad</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	len <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>len <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span><span class="token function">strcpy</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	num_strings<span class="token operator">++</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> num_strings <span class="token operator">&lt;&lt;</span> <span class="token string">":\""</span><span class="token operator">&lt;&lt;</span>str<span class="token operator">&lt;&lt;</span><span class="token string">"\" object created\n"</span><span class="token punctuation">;</span>
	
<span class="token punctuation">}</span>
<span class="token class-name">StringBad</span><span class="token double-colon punctuation">::</span><span class="token function">StringBad</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	len <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
	str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span><span class="token function">strcpy</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">"C++"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	num_strings<span class="token operator">++</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> num_strings <span class="token operator">&lt;&lt;</span> <span class="token string">":\""</span> <span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> <span class="token string">"\"default object created\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">StringBad</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">StringBad</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\""</span> <span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> <span class="token string">"\"object deleted,"</span><span class="token punctuation">;</span>
	<span class="token operator">--</span>num_strings<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> num_strings <span class="token operator">&lt;&lt;</span> <span class="token string">"left\n"</span><span class="token punctuation">;</span>
	<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>str<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> StringBad<span class="token operator">&amp;</span> st<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	os <span class="token operator">&lt;&lt;</span> st<span class="token punctuation">.</span>str<span class="token punctuation">;</span>
	<span class="token keyword">return</span> os<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注意</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> StringBad<span class="token double-colon punctuation">::</span>num_strings <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>对于静态类成员，可以在类声明之外使用单独的语句来进行初始化，这是因为静态类成员是单独存储的，而不是对象的组成部分</p><p>初始化是在方法文件中，而不是在类声明文件中进行的，这是因为类声明位于头文件中，程序可能将头文件包括在其他几个文件中。如果在头文件中进行初始化，将出现多个初始化语句副本，从而引发错误</p><p>上述中不能这样做</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">str <span class="token operator">=</span> s<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>这只保存了地址，而没有创建字符串副本</strong></p><p><strong>析构函数可以释放对象本身占用的内存，但并不能自动释放属于对象成员的指针指向的内存，因此这种情况必须使用delete语句</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">StringBad sailor <span class="token operator">=</span> sports<span class="token punctuation">;</span><span class="token comment">//1</span>
StringBad sailor <span class="token operator">=</span> <span class="token function">StringBad</span><span class="token punctuation">(</span>sports<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2</span>
<span class="token function">StringBad</span><span class="token punctuation">(</span><span class="token keyword">const</span> StringBad <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>上述三个表达式等价</p><p>当你使用一个对象来初始化另一个对象时，编译器将自动生成上述构造函数<code>3</code>（称为<strong>复制构造函数</strong>，因为它创建对象的一个副本）</p><h4 id="特殊成员函数"><a href="#特殊成员函数" class="headerlink" title="特殊成员函数"></a>特殊成员函数</h4><p><strong>C++自动提供了下面这些成员函数</strong></p><p>默认构造函数，如果没有定义构造函数</p><p>默认析构函数，如果没有定义</p><p>复制构造函数，如果没有定义</p><p>赋值运算符，如果没有定义</p><p>地址运算符，如果没有定义</p><p><strong>1.默认构造函数</strong></p><p>如果没有提供任何构造函数，C++将创建默认构造函数</p><p>但只能有一个默认构造函数，不能像下面这么做</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">Klunk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>klunk_ct <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token function">Klunk</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>klunk_ct <span class="token operator">=</span> n<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>很明显<code>Klunk s;</code>就有二义性</p><p><strong>2.复制构造函数</strong></p><p>复制构造函数用于将一个对象复制到新创建的对象中</p><p>类的复制构造函数原型通常如下</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">Class_name</span><span class="token punctuation">(</span><span class="token keyword">const</span> Class_name <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>何时调用复制构造函数(motto是一个StringBad对象)</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">StringBad <span class="token function">ditto</span><span class="token punctuation">(</span>motto<span class="token punctuation">)</span><span class="token punctuation">;</span>
StringBad metoo <span class="token operator">=</span> motto<span class="token punctuation">;</span>
StringBad also <span class="token operator">=</span> <span class="token function">StringBad</span><span class="token punctuation">(</span>motto<span class="token punctuation">)</span><span class="token punctuation">;</span>
StringBad <span class="token operator">*</span>pStringBad <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">StringBad</span><span class="token punctuation">(</span>motto<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>其中中间的两个声明可能会使用复制构造函数直接创建metoo和also，也可能使用复制构造函数生成一个临时对象，然后将临时对象的内容赋给metoo和also，这取决于具体的实现</p><p><strong>由于按值传递对象将调用复制构造函数，因此应该按引用传递对象</strong></p><p><strong>默认的复制构造函数的功能</strong></p><p>默认的复制构造函数逐个复制非静态成员（成员复制也称为浅拷贝），复制的是成员的值</p><p>下述语句</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">StringBad sailor <span class="token operator">=</span> sports<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>等价于</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">StringBad sailor<span class="token punctuation">;</span>
sailor<span class="token punctuation">.</span>str <span class="token operator">=</span> sports<span class="token punctuation">.</span>str<span class="token punctuation">;</span>
sailor<span class="token punctuation">.</span>len <span class="token operator">=</span> sports<span class="token punctuation">.</span>len<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>如果成员本身就是类对象，则将使用这个类的复制构造函数来复制成员对象</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220322182120058.png"></p><ul><li>解决程序计数问题可以通过<strong>提供显式复制构造函数</strong></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token class-name">StringBad</span><span class="token double-colon punctuation">::</span><span class="token function">StringBad</span><span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>s<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
num_strings<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>解决字符串乱码问题可以通过<strong>提供显示复制构造函数</strong></p><p>隐式构造函数</p></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">sailor<span class="token punctuation">.</span>str <span class="token operator">=</span> sport<span class="token punctuation">.</span>str<span class="token punctuation">;</span><span class="token comment">//相当于两个指针指向同一个内存地址</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>当析构函数被调用的时候</p><p>sailor所占用的内存被释放，sport指向已被释放的内存，所以出现<strong>乱码问题</strong></p><p>必须定义复制构造函数的原因在于，一些类成员是使用new初始化的、指向数据的指针，而不是数据本身。</p><p>解决这类问题就是进行<strong>深拷贝(deep copy)</strong></p><p>深度复制=&gt;不是简单复制字符串地址，而是复制字符串到新创建的副本（新地址），这样每个对象都有自己的字符串，调用析构函数都将释放不同的字符串，而不会试图去释放已经被释放的字符串</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220322185146378.png"></p><p><strong>3.赋值运算符</strong></p><p>C++允许类对象赋值，这是通过自动为类重载赋值运算符实现的,原型如下</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Class_name <span class="token operator">&amp;</span> Class_name<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Class_name <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>初始化对象时，并不一定会使用赋值运算符</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">StringBad <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">"sdasdasd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
StringBad a<span class="token punctuation">;</span>
a <span class="token operator">=</span> h<span class="token punctuation">;</span><span class="token comment">//将使用赋值运算符</span>
StringBad c <span class="token operator">=</span> a<span class="token punctuation">;</span><span class="token comment">//将使用复制构造函数</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>初始化总是会调用复制构造函数，与复制构造函数相似，赋值运算符的隐式实现也对成员进行逐个复制</p><p>赋值运算符和复制构造函数也出现相同问题：<strong>数据受损</strong>（浅拷贝引起）</p><p>解决办法就是提供赋值运算符（进行<strong>深拷贝</strong>）定义</p><ul><li>目标对象可能引用了以前分配的数据，所以函数应使用delete[]来释放这些数据</li><li>函数应当避免将对象赋给自身；否则，给对象重新赋值前，释放内存操作可能删除对象的内容</li><li>函数返回一个指向调用对象的引用</li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">StringBad <span class="token operator">&amp;</span> StringBad<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StringBad <span class="token operator">&amp;</span>st<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> <span class="token operator">&amp;</span>st<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>str<span class="token punctuation">;</span>
    len <span class="token operator">=</span> st<span class="token punctuation">.</span>len<span class="token punctuation">;</span>
    str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span> <span class="token punctuation">[</span>len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span><span class="token function">strcpy</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span>st<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​ 如果地址不同，函数将释放str指向的内存，这是因为稍后将把一个新字符串的地址赋给str。如果不首先使用delete运算符，则上述字符串保留在内存中，由于程序中不在包含指向该字符串的指针，因此这些内存被浪费掉</p><p><strong>进一步重载赋值运算符</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">String name<span class="token punctuation">;</span>
<span class="token keyword">char</span> temp<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
name <span class="token operator">=</span> temp<span class="token punctuation">;</span><span class="token comment">//程序使用构造函数String(const char *)来创建一个临时String对象</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>为了提高效率，不用创建和删除临时对象，提供一个实现</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">String <span class="token operator">&amp;</span> String<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">delete</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>str<span class="token punctuation">;</span>
    len <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span><span class="token function">strcpy</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="空指针"><a href="#空指针" class="headerlink" title="空指针"></a>空指针</h4><p><strong>大部分默认构造函数</strong>为什么代码是<code>str=new char[1];</code>而不是<code>str=new char</code>,原因是析构函数一般是delete []，要和new[]初始化的空指针对应</p><p>C++11空指针引入关键字nullptr，建议使用nullptr</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">str<span class="token operator">=</span><span class="token keyword">nullptr</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="比较成员函数"><a href="#比较成员函数" class="headerlink" title="比较成员函数"></a>比较成员函数</h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>st1<span class="token punctuation">,</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>st2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">strcmp</span><span class="token punctuation">(</span>st1<span class="token punctuation">.</span>str<span class="token punctuation">,</span>st2<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">else</span> 
<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可简化为</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>st1<span class="token punctuation">,</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>st2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">strcmp</span><span class="token punctuation">(</span>st1<span class="token punctuation">.</span>str<span class="token punctuation">,</span>st2<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>这样编写以后</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>st1<span class="token punctuation">,</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>st2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">return</span> st2<span class="token operator">&lt;</span>st1<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token comment">//借助上面&lt;重载运算符</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>st1<span class="token punctuation">,</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>st2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">strcmp</span><span class="token punctuation">(</span>st1<span class="token punctuation">.</span>str<span class="token punctuation">,</span>st2<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="中括号表示访问方法"><a href="#中括号表示访问方法" class="headerlink" title="中括号表示访问方法"></a>中括号表示访问方法</h4><p>非常量特征标</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">char</span> <span class="token operator">&amp;</span>String<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">return</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>常量特征标</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">&amp;</span>String<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{</span>
<span class="token keyword">return</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="静态类成员函数"><a href="#静态类成员函数" class="headerlink" title="静态类成员函数"></a>静态类成员函数</h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">HowMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> num_strings<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>调用它的方式如下</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token class-name">String</span><span class="token double-colon punctuation">::</span><span class="token function">howMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="构造函数中需要注意的点"><a href="#构造函数中需要注意的点" class="headerlink" title="构造函数中需要注意的点"></a>构造函数中需要注意的点</h4><ul><li>在构造函数中使用new来初始化指针成员，则应在析构函数中使用delete</li><li>new和delete必须相互兼容，new对应delete，new[]对应于delete[]</li><li>如果有多个构造函数，则必须以相同的方式使用new，要么都带中括号，要么都不带，因为只有一个析构函数来与之对应，可以引入空指针nullptr，在构造函数中将指针初始化为空，这样delete带不带括号都可以用于空指针</li><li>应定义一个复制构造函数，通过深拷贝将一个对象初始化为另一个对象[<strong>分配空间来存储复制的数据，不仅仅是复制地址</strong>]</li><li>应定义一个赋值运算符，通过深拷贝将一个对象复制给另一个对象[<strong>检查自我赋值的情况，释放成员指针以前指向的内存，然后分配空间来存储复制的数据</strong>]</li></ul><h4 id="返回对象"><a href="#返回对象" class="headerlink" title="返回对象"></a>返回对象</h4><p><strong>1.返回指向const对象的引用</strong></p><p><strong>目的：旨在提高效率</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Vector <span class="token function">force1</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Vector <span class="token function">force2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Vector max<span class="token punctuation">;</span>
max <span class="token operator">=</span> <span class="token function">Max</span><span class="token punctuation">(</span>force1<span class="token punctuation">,</span>force2<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>version1</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Vector <span class="token function">Max</span><span class="token punctuation">(</span><span class="token keyword">const</span> Vector <span class="token operator">&amp;</span>v1<span class="token punctuation">,</span><span class="token keyword">const</span> Vector <span class="token operator">&amp;</span>v2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>v1<span class="token punctuation">.</span><span class="token function">magval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span>v2<span class="token punctuation">.</span>magval<span class="token punctuation">)</span>\
<span class="token keyword">return</span> v1<span class="token punctuation">;</span>
<span class="token keyword">else</span> 
<span class="token keyword">return</span> v2<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>version2</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> Vector <span class="token operator">&amp;</span><span class="token function">Max</span><span class="token punctuation">(</span><span class="token keyword">const</span> Vector <span class="token operator">&amp;</span>v1<span class="token punctuation">,</span><span class="token keyword">const</span> Vector <span class="token operator">&amp;</span>v2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>v1<span class="token punctuation">.</span><span class="token function">magval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span>v2<span class="token punctuation">.</span><span class="token function">magval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">return</span> v1<span class="token punctuation">;</span>
<span class="token keyword">else</span>
<span class="token keyword">return</span> v2<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>version1返回对象将调用复制构造函数，version2返回引用不会，因此version2效率更高</strong></p><p><strong>2.返回指向非const对象的引用</strong></p><p>operator=()的返回值用于连续赋值</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">String <span class="token function">s1</span><span class="token punctuation">(</span><span class="token string">"Good stuff"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
String s2<span class="token punctuation">,</span>s3<span class="token punctuation">;</span>
s3 <span class="token operator">=</span> s2 <span class="token operator">=</span> s1<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>s2.operator=()的返回值被赋给s3，返回类型不是const，因为方法operator=()返回一个指向s2的引用，可以对其进行修改</p><p>operator&lt;&lt;()的返回值用于串接输出</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">String <span class="token function">s1</span><span class="token punctuation">(</span><span class="token string">"Good stuff"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cout <span class="token operator">&lt;&lt;</span> s1 <span class="token operator">&lt;&lt;</span> <span class="token string">"is coming!"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>返回类型必须是ostream &amp;，而不能仅仅是ostream，如果使用返回类型ostream，将要求调用ostream类的复制构造函数，而ostream没有公有的复制构造函数</p><p><strong>使用new初始化对象</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Class_name <span class="token operator">*</span>pclass <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Class_name</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//value的类型是type_name</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将调用</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">Class_name</span><span class="token punctuation">(</span>Type_name<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>可能还会有一些琐碎的转换</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">Class_name</span><span class="token punctuation">(</span><span class="token keyword">const</span> Type_name <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>下面的初始化方式将调用吗默认构造函数</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Class_name <span class="token operator">*</span>pclass <span class="token operator">=</span> <span class="token keyword">new</span> Class_name<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>new为对象分配内存</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">String <span class="token operator">*</span>favorite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">String</span><span class="token punctuation">(</span>sayings<span class="token punctuation">[</span>choice<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>为保存字符串地址的str指针和len成员分配内存，当程序不需要该对象时，使用delete删除它</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">delete</span> favorite<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这会释放用于保存str指针和len成员的空间，而不会释放str指向的内存</p><p><img src="https://gitee.com/zhouzejiang/blogimage/raw/master/img/image-20220325222117940.png"></p><p><img src="C:/Users/%E5%91%A8%E6%B3%BD%E6%B1%9F/AppData/Roaming/Typora/typora-user-images/image-20220325235755818.png" alt="image-20220325235755818"></p></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者: </i></span><span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">zhoumouren</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接: </i></span><span class="reprint-info"><a href="https://zhouzejiang.gitee.io/2022/02/25/C++/">https://zhouzejiang.gitee.io/2022/02/25/C++/</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明: </i></span><span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="/about" target="_blank">zhoumouren</a> !</span></div></div><script async defer>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",function(t){M.toast({html:'<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>'})})</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/C-98/"><span class="chip bg-color">C++98</span> </a><a href="/tags/C-11/"><span class="chip bg-color">C++11</span> </a><a href="/tags/c-14/"><span class="chip bg-color">c++14</span> </a><a href="/tags/C-17/"><span class="chip bg-color">C++17</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"></div></div></div></div></div><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/2022/02/27/windows/"><div class="card-image"><img src="/medias/featureimages/12.jpg" class="responsive-img" alt="windows 常用软件"> <span class="card-title">windows 常用软件</span></div></a><div class="card-content article-content"><div class="summary block-with-text"></div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2022-02-27 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/software/" class="post-category">software</a></span></div></div><div class="card-action article-tags"><a href="/tags/windows10/"><span class="chip bg-color">windows10</span> </a><a href="/tags/windows11/"><span class="chip bg-color">windows11</span> </a><a href="/tags/software/"><span class="chip bg-color">software</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/2022/02/25/hexo/"><div class="card-image"><img src="/medias/featureimages/21.jpg" class="responsive-img" alt="Hexo个人博客搭建笔记"> <span class="card-title">Hexo个人博客搭建笔记</span></div></a><div class="card-content article-content"><div class="summary block-with-text"></div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2022-02-25 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/hexo/" class="post-category">hexo</a></span></div></div><div class="card-action article-tags"><a href="/tags/hexo/"><span class="chip bg-color">hexo</span> </a><a href="/tags/git/"><span class="chip bg-color">git</span> </a><a href="/tags/node-js/"><span class="chip bg-color">node.js</span> </a><a href="/tags/github/"><span class="chip bg-color">github</span> </a><a href="/tags/gitee/"><span class="chip bg-color">gitee</span></a></div></div></div></div></article></div><script>$("#articleContent").on("copy",function(e){var n,t,o,i;void 0===window.getSelection||(""+(n=window.getSelection())).length<Number.parseInt("120")||(t=document.getElementsByTagName("body")[0],(o=document.createElement("div")).style.position="absolute",o.style.left="-99999px",t.appendChild(o),o.appendChild(n.getRangeAt(0).cloneContents()),"PRE"===n.getRangeAt(0).commonAncestorContainer.nodeName&&(o.innerHTML="<pre>"+o.innerHTML+"</pre>"),i=document.location.href,o.innerHTML+='<br />来源: ヅツツ<br />文章作者: zhoumouren<br />文章链接: <a href="'+i+'">'+i+"</a><br />本文章著作权归作者所有，任何形式的转载都请注明出处。",n.selectAllChildren(o),window.setTimeout(function(){t.removeChild(o)},200))})</script><script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script><script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script><script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script><script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget card" style="background-color:#fff"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="/libs/tocbot/tocbot.min.js"></script><script><script src="/libs/tocbot/tocbot.min.js"></script><script>$(function(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-(.4*$(window).height()-45),collapseDepth:Number("1"),headingSelector:"h1,h2,h3,h4"});let t=0,e="toc-heading-",n=($("#toc-content a").each(function(){$(this).attr("href","#"+e+ ++t)}),t=0,$("#articleContent").children("h1,h2,h3,h4").each(function(){$(this).attr("id",e+ ++t)}),parseInt(.4*$(window).height()-64)),o=$(".toc-widget");$(window).scroll(function(){$(window).scrollTop()>n?o.addClass("toc-fixed"):o.removeClass("toc-fixed")});const i="expanded";let c=$("#toc-aside"),a=$("#main-content");$("#floating-toc-btn .btn-floating").click(function(){c.hasClass(i)?(c.removeClass(i).hide(),a.removeClass("l9")):(c.addClass(i).show(),a.addClass("l9"));{var t,n="prenext-posts";let e=$("#"+"artDetail");if(0!==e.length){let t=e.width();450<=t?t+=21:350<=t&&t<450?t+=18:300<=t&&t<350?t+=16:t+=14,$("#"+n).width(t)}return}})})</script></main><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:15px!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">-2022</span> <span id="year"></span><br>&nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span class="white-color">32.6k</span>&nbsp;字 <span id="busuanzi_container_site_pv">|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv" class="white-color"></span>&nbsp;次 </span><span id="busuanzi_container_site_uv">|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv" class="white-color"></span>&nbsp;人</span><br><span id="sitetime">载入运行时间...</span><script>function siteTime(){var e=36e5,t=24*e,n=new Date,o=n.getFullYear(),r=n.getMonth()+1,a=n.getDate(),i=n.getHours(),l=n.getMinutes(),n=n.getSeconds(),m=Date.UTC("","2","27","0","0","0"),r=Date.UTC(o,r,a,i,l,n)-m,a=Math.floor(r/31536e6),i=Math.floor(r/t-365*a),l=Math.floor((r-(365*a+i)*t)/e),n=Math.floor((r-(365*a+i)*t-l*e)/6e4),m=Math.floor((r-(365*a+i)*t-l*e-6e4*n)/1e3);""==o?(document.getElementById("year").innerHTML=o,document.getElementById("sitetime").innerHTML="本站已安全运行 "+i+" 天 "+l+" 小时 "+n+" 分钟 "+m+" 秒"):(document.getElementById("year").innerHTML=" - "+o,document.getElementById("sitetime").innerHTML="本站已安全运行 "+a+" 年 "+i+" 天 "+l+" 小时 "+n+" 分钟 "+m+" 秒")}setInterval(siteTime,1e3)</script><br></div><div class="col s12 m4 l4 social-link social-statis"></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script type="text/javascript">$(function(){!function(t,r,s){"use strict";$.ajax({url:t,dataType:"xml",success:function(t){var e=$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),t=document.getElementById(r),n=document.getElementById(s);t.addEventListener("input",function(){var o='<ul class="search-result-list">',h=this.value.trim().toLowerCase().split(/[\s\-]+/);n.innerHTML="",this.value.trim().length<=0||(e.forEach(function(t){var n,e,r,s=!0,i=t.title.trim().toLowerCase(),l=t.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),a=0===(a=t.url).indexOf("/")?t.url:"/"+a,c=-1,u=-1;""!==i&&""!==l&&h.forEach(function(t,e){n=i.indexOf(t),c=l.indexOf(t),n<0&&c<0?s=!1:(c<0&&(c=0),0===e&&(u=c))}),s&&(o+="<li><a href='"+a+"' class='search-result-title'>"+i+"</a>",a=t.content.trim().replace(/<[^>]+>/g,""),0<=u&&(t=u+80,(t=0===(e=(e=u-20)<0?0:e)?100:t)>a.length&&(t=a.length),r=a.substr(e,t),h.forEach(function(t){var e=new RegExp(t,"gi");r=r.replace(e,'<em class="search-keyword">'+t+"</em>")}),o+='<p class="search-result">'+r+"...</p>"),o+="</li>")}),o+="</ul>",n.innerHTML=o)})}})}("/search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="/libs/materialize/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0],e=(t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",document.getElementsByTagName("script")[0]);e.parentNode.insertBefore(t,e)}()</script><script src="/libs/others/clicklove.js" async></script><script async src="/libs/others/busuanzi.pure.mini.js"></script><script type="text/javascript" color="0,0,255" pointcolor="0,0,255" opacity="0.7" zindex="-1" count="79" src="/libs/background/canvas-nest.js"></script><script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async></script><script src="/libs/instantpage/instantpage.js" type="module"></script></body></html>